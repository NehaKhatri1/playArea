<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">

<body onload="noBack();" 
    onpageshow="if (event.persisted) noBack();" onunload="">
  
        <!-- start of present full screen div -->
        <div id="fullScreenDiv"
                style="top:0;left:0;width: 100%; height: 100%; position: absolute; background-color: black;border-style:none;">

                 <!-- div for tabs controller -->
                 <div id="zones" class="tab ui-widget"  style="top:0;bottom:96%;left:0;right:0;width: 98%;height: 3.5%; position: absolute; background-color: black;border-style:none;">
                  <button id="defaultOpen" class="tablinks" onclick="openCity(event, 'fullScreenDivForMyHome')"> <span> <font id="tabOne" color="white"> MyLibrary</font></span> </button>
                   <button class="tablinks" onclick="openCity(event, 'fullScreenDivForThinkers')"><span> <font  id="tabTwo" color="white"> Thinkers</font></span> </button>
                  <button class="tablinks" onclick="openCity(event, 'fullScreenDivForBooks')"><span> <font  id="tabThree" color="white"> Books</font></span> </button>
                  <input id = "searchThinkers" style="position: absolute; left: 50%;top:1px;background-color: orange;color:white;font-family:cursive; ;border-style: solid;border-color:orange;" value=" Search thinkers ..." ></input>
                   <input id = "searchBooks" style="position: absolute; left: 50%;top:1px;background-color: orange;color:white;font-family:cursive ;border-style: solid;border-color:orange;" value=" Search books ..." ></input> &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp <span id="waitSymbol"  style="font-family: cursive;display: none" >   <font size="3" color="yellow" font-family=" cursive" >Please wait ....   </font></span>
                                          <span  id="registerPlaceHolder"  style="font-family: cursive" >   <font size="3" color="white" font-family=" cursive" ><a style="color:white"; href="http://localhost:8080/portal"> Register </a></font></span>
                                         <span  id="logoutPlaceHolder"  style="font-family: cursive" >   <font id="logoutFont" size="3" color="white" font-family=" " ><a style="color:orange"; href="http://localhost:8080/portal"> logout </a></font></span>
                </div>

                 <!-- catch :  zones div bottom and height is 100% , similarly for my home , top and height is 100% -->


            <!-- start of present my home div -->
            <div id="fullScreenDivForMyHome" class="tabcontent"
                style="top:4%;left:0;width: 98%; height: 95.5%; position: absolute; background-color: black;border-style:none;">
                
                
                <!--  end of the header div -->
                
                <!-- div used for the login screen -->
           <div id="myProfilePanel"
                        style="top: 5%; left: .01%; right: 74%; bottom: .01%; position: absolute; background-color: black;border-style:none;">

                                 <div id="welcomeTextPanel"
                        style="top: 3%; left: 16%; right: 16%; bottom: 93.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                                <span >
                              
                                
                                <font id="welcomeText"  color="white"><strong>    welcome : </strong></font> 
                                        
                                
                                </span>

                                </div>
                                <div id="imagePanel"
                        style="top: 11%; left: 14%; right: 16%; bottom: 68.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                               <!--  <image id="profilePic" width="130" height="130" style="border-radius:5px" /> -->
                            </div>
                            
                            <div id="adPanel"
                        style="top: 45%; left: 14%; right: 16%; bottom: 15%; overflow-y :auto;position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                               
                                                <!-- <br>
                                                <br>
                                                <label id="testLabelForResponsive" style="color:white;font-style: helvetica;">  Categories : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                                <br>
                                                <select id="dropDown">
                                                  <option value="Please select">Please select</option>
                                                </select>
                                                <br>
                                                <br>

                                                <label id="labelForBooksResponsive" style="color:white" >  Books : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 
                                                  <br>
                                                  <select id="dropDownBooks">
                                                  <option value="Please select book">Please select book</option>
                                                </select>
                                                <br>
                                                <br>

                                                <input size="8" id="newCategoryInputId" value="category " class="reClear2" style="border-radius:5px;" ></input> &nbsp&nbsp
                                                  <br>
                                                  <br>
                                                <button class="buttonForBooks" id="newCategoryInputButtonId"> Create </button>    
                                                 <br>
                                                 <br> -->
                                               <!--  <button id="paymentButton" > pay </button> -->
                                         

                                               

                            </div>
                                
                </div> <!-- end of profile panel -- >


                <!-- start of the right div -->

                <div id="myLibraryPanel" 
                        style="top: .01%; left: 21%; right: .01%; bottom: .01%; position: absolute; background-color:black;border-style:none">
                              
                                      <div id="libraryControllerLoginPanel"
                        style="top: .01%; left: 1%; right: .5%; bottom: 91%; position: absolute; background-color: black;border-style:none ; border-radius: 25px; overflow-y :auto;text-align: center;">
                                               <!--  <image id="profilePic" width="50" height="50" style="border-radius:5px" /> -->
                                               
                                                <label id="testLabelForResponsive" style="color:white;font-style: helvetica;">  Categories : </label>
                                                
                                                <select id="dropDown">
                                                  <option value="Please select">Please select</option>
                                                </select> &nbsp &nbsp &nbsp
                                                

                                                <label id="labelForBooksResponsive" style="color:white" >  Books : </label>
                                                  
                                                  <select id="dropDownBooks">
                                                  <option value="Please select book">Please select book</option>
                                                </select>  &nbsp &nbsp

                                               
                                               
                                               <br> 
                                                <br> 



                                              &nbsp &nbsp&nbsp&nbsp &nbsp&nbsp &nbsp&nbsp &nbsp &nbsp &nbsp&nbsp &nbsp&nbsp &nbsp&nbsp&nbsp &nbsp&nbsp &nbsp &nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp <input size="10" id="newCategoryInputId" value="New Category " class="reClear2" style="border-radius:5px;" ></input> &nbsp  &nbsp  &nbsp
                                                  
                                                <button class="buttonForBooks" id="newCategoryInputButtonId"> Create </button> &nbsp &nbsp &nbsp   &nbsp &nbsp &nbsp  &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp&nbsp &nbsp&nbsp &nbsp&nbsp &nbsp &nbsp &nbsp &nbsp&nbsp &nbsp&nbsp &nbsp&nbsp &nbsp&nbsp &nbsp
                                                 
                                         
                                    </div>
                               


                                <div id="libraryBookWriteZonePanel"
                        style="top: 10%; left: 1%; right: .5%; bottom: 1%; position: absolute; background-color: #FFFFFF;border-style:none ; border-radius: 25px; overflow-y :auto;">


                                        <div id="upperDiv" style="left:35%;right:23%;top:1%;bottom:91%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                <br>
                                                <input id="newBookId" size="16" value=" Book title .. " style="border-radius:5px;border-style: solid;border-color: orange;border-width: thick;"></input> &nbsp  &nbsp  &nbsp  &nbsp  &nbsp  &nbsp &nbsp &nbsp&nbsp<!-- <label id="labelForTopicName"> TOPIC NAME : </label> --> <input size="11" id="newTopicInputId" style="border-radius:5px;border-style: solid;border-color: orange;border-width: thick;" value="Topic Name .." class="reClear2"></input>
                                                <!-- <br> -->
                                                
                                                
                                        </div>


                                        <div id="innerDiv" style="left:1%;right:1%;top:9%;bottom:7%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y:auto">
                                <p id="titleId"></p>
                                        
                                        <div id="divTextArea" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none;white-space: pre-wrap;font-weight:590;font-color:black;font-style: helvetica;border:solid;border-width: thin;overflow-y:auto;word-wrap: break-word;" class="notes"  contenteditable="true" class="textEditor" >


                                                
                                        </div>

                                        </div>



                                        <div id="bottomDiv" style="left:33%;right:23%;top:90.5%;bottom:2%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                 <pre><label id="labelForTopicNumber"> TOPIC NUMBER  </label><select id="topicDropDown" >
                                                 <optgroup >
                                                  <option class="service-small" value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option class="service-small" value="9">9</option>
                                                  <option value="10">10</option></optgroup></select>  &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<button class="buttonForBooks"  title="create new book / update existing book contents" class="masterTooltip" id="newBookButtonId" ><span> <font id="postBook" color="white"> post </font></span> </button> <!-- <label>  BOOK-PRICE (INR) : </label> <input size="4" id="bookPrice" style="border-radius:5px;" value="0.00" class="reClear2"></input> -->  <!-- <button id="addImageId">Add Image</button> -->
                                </pre>
                                        </div>
                                                

                                </div>

                         

                </div>                <!-- end of the my library div -->


                 

        
        </div> 

        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <div id="bookLayout" style="left:3%;top:3%;right:3%;bottom:3%;width: 96%; height: 96%; position: absolute; background-color: white;border-radius: 25px;z-index:5;display:none;">
                

                <div id="topDiv" style="left:27%;right:30%;top:2%;bottom:92%;height:3%;width:50%; position: absolute; background-color: white;z-index:;border-radius: 25px;">
                                <table align="center">
                                <tr>
                                <th><label id="bookTitleWhileRead"> Book name : </label></th>
                                
                            </tr>
                            <tr>
                                <th><pre><label>TOPIC NUMBER  </label><select id="topicDropDownWhileRead">
                                                  <option value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option value="9">9</option>
                                                  <option value="10">10</option></select> <label id="topicFetchedWhileRead"></label>
                                </pre></th>        
                            </tr>
                            </table>
                        </div>
        
                <div id="innerDiv" style="left:7%;right:3%;top:12%;bottom:6%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y: auto;">
                <p id="titleId"></p>
                        
                        <div  id="divTextAreaForRead" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none; border: solid;border-width: thin;white-space : pre-wrap ; overflow-y: auto;" class="notes" contenteditable="true" class="textEditor">

                                
                        </div>
                </div>

                <div id="bottomDiv" style="left:33%;right:28%;top:92%;bottom:2.5%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                        <table align="center">
                        <tr>
                        <th><button class="buttonCloseBook" id="closeButton">   Close  </button></th>
                    </tr>
                    </table>
                </div>
                

        </div>
                

        </div> <!-- end of full screen div for myHome present -->


         <!-- start of presentThinkers div -->
         <div id="fullScreenDivForThinkers" class="tabcontent"
                style="top:4%;left:0;width: 98%; height: 95.5%; position: absolute; background-color: black;border-style:none;">
                
               

                <div id="myProfilePanelThinkers"
                        style="top: 5%; left: .01%; right: 74%; bottom: .01%; position: absolute; background-color: black;border-style:none;">

                                 <div id="welcomeTextPanelThinkers"
                        style="top: 3%; left: 18%; right: 16%; bottom: 93.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                                <span style="font-family: ">
                              
                                <p>
                                        <font id="welcomeTextThinkers" size="4" color="white"><strong>    welcome : </strong></font> 
                                        
                                </p>
                                </span>

                                </div>
                                <div id="imagePanelThinkers"
                        style="top: 11%; left: 14%; right: 16%; bottom: 68.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                                <image id="profilePicThinkers" width="170" height="170" style="border-radius:5px" src="css/image.jpg" />
                            </div>
                            
                            <div id="adPanelThinkers"
                        style="top: 45%; left: 14%; right: 16%; bottom: 15%; overflow-y :auto;position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                               
                                                <br>
                                                <br>
                                                <label style="color:white">  Categories : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                                <br>
                                                <select id="dropDownThinkers">
                                                  <option value="Please select">Please select</option>
                                                </select>
                                                <br>
                                                <br>

                                                <label style="color:white" >  Books : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 
                                                  <br>
                                                  <select id="dropDownBooksThinkers">
                                                  <option value="Please select book">Please select book</option>
                                                </select>
                                                <br>
                                                <br>

                                                <input size="8" id="newCategoryInputIdThinkers" value="category " class="reClear2" style="border-radius:5px;" ></input> &nbsp&nbsp<button class="buttonForBooks" id="newCategoryInputButtonIdThinkers"> Create </button>    
                                                 <br>
                                                 <br>

                                               

                            </div>
                                
                </div> <!-- end of profile panel -- >


                <!-- start of the right div -->

                <div id="myLibraryPanelThinkers" 
                        style="top: .01%; left: 21%; right: .01%; bottom: .01%; position: absolute; background-color:black;border-style:none">
                              
                                      <div id="libraryControllerLoginPanelThinkers"
                        style="top: .01%; left: 1%; right: .5%; bottom: 96%; position: absolute; background-color: black;border-style:none ; border-radius: 25px; overflow-y :auto;text-align: right;">
                                         <span id="waitSymbolThinkers"  style="font-family: cursive;display: none" >   <font size="3" color="yellow" font-family=" cursive" >Please wait ....   </font></span>
                                          <span  id="registerPlaceHolderThinkers"  style="font-family: cursive" >   <font size="3" color="white" font-family=" cursive" ><a style="color:white"; href="http://localhost:8080/portal"> home </a></font></span>
                                         <span  id="logoutPlaceHolderThinkers"  style="font-family: cursive" >   <font size="3" color="white" font-family=" cursive" ><a style="color:white"; href="http://localhost:8080/portal"> logout </a></font></span>
                                    </div>
                               


                                <div id="libraryBookWriteZonePanelThinkers"
                        style="top: 5%; left: 1%; right: .5%; bottom: 1%; position: absolute; background-color: #FFFFFF;border-style:none ; border-radius: 25px; overflow-y :auto;">


                                        <div id="upperDivThinkers" style="left:35%;right:23%;top:1%;bottom:91%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                <br>
                                                <input id="newBookIdThinkers" size="16" value=" book title " style="border-radius:5px;"></input>  &nbsp<button class="buttonForBooks" title="create new book / update existing book contents" class="masterTooltip" id="newBookButtonIdThinkers" >Create / Update Book</button>
                                                
                                        </div>


                                        <div id="innerDivThinkers" style="left:1%;right:1%;top:9%;bottom:7%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y:auto">
                                <p id="titleId"></p>
                                        
                                        <div id="divTextAreaThinkers" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none;white-space: pre-wrap;font-weight:590;font-color:black;font-style: helvetica;border: solid;border-width: thin;overflow-y:auto" class="notes" contenteditable="true" class="textEditor" >


                                                
                                        </div>
                                        </div>



                                        <div id="bottomDivThinkers" style="left:17%;right:23%;top:90.5%;bottom:2%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                 <pre>     <label> TOPIC NUMBER  </label><select id="topicDropDownThinkers">
                                                  <option value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option value="9">9</option>
                                                  <option value="10">10</option></select> <label> ENTER TOPIC NAME : </label><input size="14" id="newTopicInputIdThinkers" style="border-radius:5px;" value="" class="reClear2"></input>
                                </pre>
                                        </div>
                                                

                                </div>

                         

                </div>                <!-- end of the my library div -->


                 

        
        </div> 

        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <div id="bookLayoutThinkers" style="left:3%;top:3%;right:3%;bottom:3%;width: 96%; height: 96%; position: absolute; background-color: white;border-radius: 25px;z-index:5;display:none;">
                

                <div id="topDivThinkers" style="left:27%;right:30%;top:2%;bottom:92%;height:3%;width:50%; position: absolute; background-color: white;z-index:;border-radius: 25px;">
                                <table align="center">
                                <tr>
                                <th><label id="bookTitleWhileReadThinkers"> Book name : </label></th>
                                
                            </tr>
                            <tr>
                                <th><pre><label>TOPIC NUMBER  </label><select id="topicDropDownWhileReadThinkers">
                                                  <option value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option value="9">9</option>
                                                  <option value="10">10</option></select> <label id="topicFetchedWhileReadThinkers"></label>
                                </pre></th>        
                            </tr>
                            </table>
                        </div>
        
                <div id="innerDivThinkers" style="left:7%;right:3%;top:12%;bottom:6%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y: auto;">
                <p id="titleIdThinkers"></p>
                        
                        <div readonly id="divTextAreaForReadThinkers" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none;border: solid;border-width: thin;overflow-y: auto;white-space : pre-wrap ;" class="notes" contenteditable="true" class="textEditor">

                                
                        </div>
                </div>

                <div id="bottomDivThinkers" style="left:33%;right:28%;top:92%;bottom:2.5%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                        <table align="center">
                        <tr>
                        <th><button class="buttonCloseBook" id="closeButtonThinkers">   Close  </button></th>
                    </tr>
                    </table>
                </div>
                

        </div>


                

        </div> <!-- end of presentThinkers -->


         <!-- start of presentBooks div -->
         <div id="fullScreenDivForBooks" class="tabcontent"
                style="top:4%;left:0;width: 98%; height: 95.5%; position: absolute; background-color: black;border-style:none;">
                
               
                


                <div id="myProfilePanelBooks"
                        style="top: 5%; left: .01%; right: 74%; bottom: .01%; position: absolute; background-color: black;border-style:none;">

                                 <div id="welcomeTextPanelBooks"
                        style="top: 3%; left: 18%; right: 16%; bottom: 93.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                                <span style="font-family: ">
                              
                                <p>
                                        <font id="welcomeTextBooks" size="4" color="white"><strong>    welcome : </strong></font> 
                                        
                                </p>
                                </span>

                                </div>
                                <div id="imagePanelBooks"
                        style="top: 11%; left: 14%; right: 16%; bottom: 68.5%; position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                                <image id="profilePicBooks" width="170" height="170" style="border-radius:5px" src="css/image.jpg" />
                            </div>
                            
                            <div id="adPanelBooks"
                        style="top: 45%; left: 14%; right: 16%; bottom: 15%; overflow-y :auto;position: absolute; background-color: black;border-style:outset;border: 4px solid black;">
                               
                                                <br>
                                                <br>
                                                <label style="color:white">  Categories : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                                <br>
                                                <select id="dropDownCategoryBooks">
                                                  <option value="Please select">Please select</option>
                                                </select>
                                                <br>
                                                <br>

                                                <label style="color:white" >  Books : </label>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 
                                                  <br>
                                                  <select id="dropDownBooksBooks">
                                                  <option value="Please select book">Please select book</option>
                                                </select>
                                                <br>
                                                <br>

                                                <input size="8" id="newCategoryInputIdBooks" value="category " class="reClear2" style="border-radius:5px;" ></input> &nbsp&nbsp<button class="buttonForBooks" id="newCategoryInputButtonIdBooks"> Create </button>
                                                <label style="color:white" id="purposeOfPaymentCodeId">PurposeOfPaymentCode : </label>
                                                <br>
                                                <br>
                                                <button id="paymentButton" > pay </button>
                                                <br>
                                                <br>
                                                <label style="color:white" id="agreementTextId"> I shall respect copyrights of the purchased book </label>
                                                <br>
                                                <br>
                                                <button id="agreeId" > I agree </button>

                                               

                            </div>
                                
                </div> <!-- end of profile panel -- >


                <!-- start of the right div -->

                <div id="myLibraryPanelBooks" 
                        style="top: .01%; left: 21%; right: .01%; bottom: .01%; position: absolute; background-color:black;border-style:none">
                              
                                      <div id="libraryControllerLoginPanelBooks"
                        style="top: .01%; left: 1%; right: .5%; bottom: 96%; position: absolute; background-color: black;border-style:none ; border-radius: 25px; overflow-y :auto;text-align: right;">
                                         <span id="waitSymbolBooks"  style="font-family: cursive;display: none" >   <font size="3" color="yellow" font-family=" cursive" >Please wait ....   </font></span>
                                          <span  id="registerPlaceHolderBooks"  style="font-family: cursive" >   <font size="3" color="white" font-family=" cursive" ><a style="color:white"; href="http://localhost:8080/portal"> home </a></font></span>
                                         <span  id="logoutPlaceHolderBooks"  style="font-family: cursive" >   <font size="3" color="white" font-family=" cursive" ><a style="color:white"; href="http://localhost:8080/portal"> logout </a></font></span>
                                    </div>
                               


                                <div id="libraryBookWriteZonePanelBooks"
                        style="top: 5%; left: 1%; right: .5%; bottom: 1%; position: absolute; background-color: #FFFFFF;border-style:none ; border-radius: 25px; overflow-y :auto;">


                                        <div id="upperDivBooks" style="left:35%;right:23%;top:1%;bottom:91%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                <br>
                                                <input id="newBookIdBooks" size="16" value=" book title " style="border-radius:5px;"></input>  &nbsp<button class="buttonForBooks" title="create new book / update existing book contents" class="masterTooltip" id="newBookButtonIdBooks" >Create / Update Book</button>
                                                
                                        </div>


                                        <div id="innerDivBooks" style="left:1%;right:1%;top:9%;bottom:7%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y:auto">
                                <p id="titleId"></p>
                                        
                                        <div id="divTextAreaBooks" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none;white-space: pre-wrap;font-weight:590;font-color:black;font-style: helvetica;border: solid;border-width: thin;overflow-y:auto" class="notes" contenteditable="true" class="textEditor" >


                                                
                                        </div>
                                        </div>



                                        <div id="bottomDivBooks" style="left:17%;right:23%;top:90.5%;bottom:2%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                                                 <pre>     <label> TOPIC NUMBER  </label><select id="topicDropDownBooks">
                                                  <option value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option value="9">9</option>
                                                  <option value="10">10</option></select> <label> ENTER TOPIC NAME : </label><input size="14" id="newTopicInputIdBooks" style="border-radius:5px;" value="" class="reClear2"></input>
                                </pre>
                                        </div>
                                                

                                </div>

                         

                </div>                <!-- end of the my library div -->


                 

        
        </div> 

        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <!-- Following code is for the pop up div at another z index which will render the contents of the book : -->
        <div id="bookLayoutBooks" style="left:3%;top:3%;right:3%;bottom:3%;width: 96%; height: 96%; position: absolute; background-color: white;border-radius: 25px;z-index:5;display:none;">
                

                <div id="topDivBooks" style="left:27%;right:30%;top:2%;bottom:92%;height:3%;width:50%; position: absolute; background-color: white;z-index:;border-radius: 25px;">
                                <table align="center">
                                <tr>
                                <th><label id="bookTitleWhileReadBooks"> Book name : </label></th>
                                
                            </tr>
                            <tr>
                                <th><pre><label>TOPIC NUMBER  </label><select id="topicDropDownWhileReadBooks">
                                                  <option value="1">1</option>
                                                  <option value="2">2</option>
                                                  <option value="3">3</option>
                                                  <option value="4">4</option>
                                                  <option value="5">5</option>
                                                  <option value="6">6</option>
                                                  <option value="7">7</option>
                                                  <option value="8">8</option>
                                                  <option value="9">9</option>
                                                  <option value="10">10</option></select> <label id="topicFetchedWhileReadBooks"></label>
                                </pre></th>        
                            </tr>
                            </table>
                        </div>
        
                <div id="innerDivBooks" style="left:7%;right:3%;top:12%;bottom:6%; position: absolute; background-color: white;z-index:5;border-radius: 25px;overflow-y: auto;">
                <p id="titleIdBooks"></p>
                        
                        <div readonly id="divTextAreaForReadBooks" style="width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:18px;z-index:5;position: absolute;outline:none;border: solid;border-width: thin;overflow-y: auto;white-space : pre-wrap ;" class="notes" contenteditable="true" class="textEditor">

                                
                        </div>
                </div>

                <div id="bottomDivBooks" style="left:33%;right:28%;top:92%;bottom:2.5%; position: absolute; background-color: white;z-index:5;border-radius: 25px;">
                        <table align="center">
                        <tr>
                        <th><button class="buttonCloseBook" id="closeButtonBooks">   Close  </button></th>
                    </tr>
                    </table>
                </div>
                

          </div>



        </div> <!-- end of presentBooks div -->




         
       
        </div>  <!-- end of full screen div present -->






</body>


<head>
 <meta charset="UTF-8">
 <!--  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">   -->
   

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script> 





<style>

optgroup { font-weight: bolder;background-color: black;color: white; }
.notes {
    background-attachment: local;
    background-image:
        linear-gradient(to right, white 10px, transparent 10px),
        linear-gradient(to left, white 10px, transparent 10px),
        repeating-linear-gradient(white, white 30px, #ccc 30px, #ccc 31px, white 31px);
    line-height: 31px;
    padding: 8px 10px;
}
.buttonForBooks{
    background-color: green; /* Green */
    border: none;
    color: white;
    padding: 7px 16px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 9px;
    border-radius:5px;
}
.buttonCloseBook {
    background-color: green; 
    border: none;
    color: white;
    padding: 12px 26px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 12px;
    border-radius:5px;
}
.tooltip {
    display:none;
    position:absolute;
    border:1px solid #333;
    background-color:#161616;
    border-radius:5px;
    padding:10px;
    color:#fff;
    font-size:12px Arial;
}

/* Style the tab */
div.tab {
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
   
}

/* Style the buttons inside the tab */
div.tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 4px 14px;
    transition: 0.3s;
    font-size: 15px;
    font-color:white;
    font-family: ;
   
}

/* Change background color of buttons on hover */
div.tab button:hover {
    background-color: orange;
    
}

/* Create an active/current tablink class */
div.tab button.active {
    background-color: orange;
   
}

/* Style the tab content */
.tabcontent {
    display: none;
    padding: 1px 8px;
    border: 1px solid red;
    border-top: none;
    
}

@media (min-width: 768)
{
       body
       {
           font-size: 17px; 
       }
      
}

</style>
<title>thoughtsbook</title>        
 





<script type="text/javascript">


$(document).ready(function(){

window.history.forward();
    function noBack() { window.history.forward(); }



        // start of code for tooltip

        $('.masterTooltip').hover(function(){
        // Hover over code
        var title = $(this).attr('title');
        $(this).data('tipText', title).removeAttr('title');
        $('<p class="tooltip"></p>')
        .text(title)
        .appendTo('body')
        .fadeIn('slow');
            }, function() {
                    // Hover out code
                    $(this).attr('title', $(this).data('tipText'));
                    $('.tooltip').remove();
            }).mousemove(function(e) {
                    var mousex = e.pageX + 20; //Get X coordinates
                    var mousey = e.pageY + 10; //Get Y coordinates
                    $('.tooltip')
                    .css({ top: mousey, left: mousex })
        });
        
        // end of code for tooltip
 


    
            // jquery get method check on portal dev
             /*jQuery.ajax({
                        url: "http://localhost:8080/odlPortal/odlPortal/login/aparnesh/gaurav",
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            alert(" result :  "+data);
                    }   
                        }); */


            // jquery post method check on portal dev
             /*jQuery.ajax({
                        url: "http://localhost:8080/odlPortal/odlPortal/loginOdlPortal",
                        type:"POST",
                        contentType: "text/plain",
                        data: "**********************REGISTRATION DATA**********************",
                        success: function(data){
                            // alert("Registered : "+data);
                            // alert("registered:"+data);
                            alert("data is : "+data);
                    }   
                });*/



              
    // this part would do the device responsiveness work , it would increase font size and weight of elements which are indicative , 
    // thankfully , the core text is already coming good with varying device sizes . 
    if(window.devicePixelRatio==2){
         $("#testLabelForResponsive").prop("style","font-size:30px;color:white;font-weight:bold;");
         $("#labelForBooksResponsive").prop("style","font-size:30px;color:white;font-weight:bold;");
           $("#labelForTopicNumber").prop("style","font-size:25px;font-weight:bold");
           // $("#labelForTopicName").prop("style","font-size:25px;font-weight:bold");
         $("#newCategoryInputId").prop("style","border-radius:5px;font-size:30px;font-weight:bold;");
         $("#newBookId").prop("style","border-radius:5px;font-size:30px;font-weight:bold;");
         $("#newTopicInputId").prop("style","border-radius:5px;font-size:30px;font-weight:bold;");
         $("#topicDropDown").prop("style","font-size:30px;font-weight: bolder")
          $("#dropDown").prop("style","font-size: 30px;font-weight: bolder;background-color: white;color: black;")
           $("#dropDownBooks").prop("style","font-size: 30px;font-weight: bolder;background-color: white;color: black;")
         
          $("#newCategoryInputButtonId").prop("style","font-size:25px;");
         $("#divTextArea").prop("style","width:90%;left:5%;right:5%;top:5%;bottom:5%;font-size:50px;z-index:5;position: absolute;outline:none;white-space: pre-wrap;font-weight:590;font-color:black;font-style: helvetica;border:solid;border-width: thin;overflow-y:auto;word-wrap: break-word;");
         $("#welcomeText").prop("size","6px");
         $("#logoutFont").prop("size","6");
         // $("#logoutFont").prop("weight","bold");
         $("#welcomeText").prop("weight","bold");
         $("#tabOne").prop("size","6px");
         $("#tabOne").prop("weight","bold");
         $("#tabTwo").prop("size","6px");
         $("#tabTwo").prop("weight","bold");
         $("#tabThree").prop("size","6px");
         $("#tabThree").prop("weight","bold");
          $("#postBook").prop("size","6px");
         $("#postBook").prop("weight","bold");

         // style="left:35%;right:23%;top:1%;bottom:91%; position: absolute; background-color: white;z-index:5;border-radius: 25px;"
           $("#myLibraryPanel").prop("style","top: .01%; left: 2%; right: .01%; bottom: .01%; position: absolute; background-color:black;border-style:none");
         $("#upperDiv").prop("style","left:6%;right:23%;top:1%;bottom:91%; position: absolute; background-color: white;z-index:5;border-radius: 25px;");
           // style="top: .01%; left: 21%; right: .01%; bottom: .01%; position: absolute; background-color:black;border-style:none">
         
         
       
    }


              
               


        // start of history api usecase
        var currentUrl = window.location.href;
        if(currentUrl.indexOf("library") > 0 ){

                 //startOfGuest
                 // alert("startOfGuest");

                var currentUrlParsed = currentUrl.split("library"); 
                // alert("currentUrlParsed is: "+currentUrlParsed);
                var userCategoryBookParsed = currentUrlParsed[1].split("/");
                var userName = userCategoryBookParsed[1];
                var categoryName = userCategoryBookParsed[2];
                var bookTrimmedName = userCategoryBookParsed[3];
                /*alert("userName is : "+userName);
                alert("category name is : "+categoryName);
                alert("bookTrimmedName is : "+bookTrimmedName);*/
                // alert("userName is : "+userName);

                // initializing the wait symbol while jquery ajax call
                // $("#waitSymbol").show();
               

                 $("#welcomeText").text("Thinker :  "+userName);  

                 // disabling some of the buttons for the logged out user
                 $("#logoutPlaceHolder").hide(); // disabling the logout button , enabling of login button should come here itself by writing one more  span in html
                 // by keeing that hidden and showing for logged user entrance .
                 // alert("here");
                  $("#newBookButtonId").hide(); // disabling create / update book button for logged out user  , working presently on this .
                  $("#newCategoryInputButtonId").hide();
                  $("#newCategoryInputId").hide();
                  
                  $("#waitSymbol").hide();

                  // alert(bookTrimmedName);

                  // case when guest only gives library/username
                  if(bookTrimmedName==undefined){
                   $("#profilePicThinkers").prop("src","../css/image.jpg");
                   $("#profilePicBooks").prop("src","../css/image.jpg");
                  }
                  // case when guest only gives library/username/category/bookname
                  else{
                    $("#profilePicThinkers").prop("src","../../../css/image.jpg");
                    $("#profilePicBooks").prop("src","../../../css/image.jpg");
                  }

                  // zones hiding 
                  // $("#zones").hide();

                  // to be handled ( this shouldn't be editable )

                  $("textarea").prop("readonly","true");
                  // $("input").prop("disabled","true");

                  $("#newBookId").prop("disabled","true");
                  $("#newBookIdThinkers").prop("disabled","true");
                  $("#newBookIdBooks").prop("disabled","true");

                  $("#newTopicInputId").prop("disabled","true");
                   $("#newTopicInputIdThinkers").prop("disabled","true");
                    $("#newTopicInputIdBooks").prop("disabled","true");
                  /*$("#searchThinkers").prop("disabled","false");
                  $("#searchBooks").prop("readonly","false");*/
                  
                
                  // hide register/login place holder
                   // $("#registerPlaceHolder").hide();


                  

                   // alert($("#dropDown").val());
                   // alert("category name is : "+categoryName);
                   // $("#dropDown :selected").text(categoryName).attr("selected", "selected"); // setting the category on landing of logged out user.
                   // end of disabling of buttons for the logged out user 

                // $("#waitSymbol").show();
                jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            // alert("categoryname is : "+categoryName);
                            if(categoryName==null){
                              // alert("matched here"); 
                             }
                             else{
                               history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                             }
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputId").val(topicName);
                         $("#divTextArea").text(pageContentWithoutPreValue);
                         $("#topicDropDown").val("1");
                         $("#newBookId").val(bookTrimmedName);

                         // hiding the wait button
                        // $("#waitSymbol").hide();

                    }   
                        });

                    // displaying the list of categories for the logged out user
                    var listOfCategories = "";
                    var ddl = "#dropDown";
                    var ddlBooks = "#dropDownBooks";
                                    jQuery.ajax({
                                                    url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+userName,
                                                    dataType: 'text',
                                                    success: function(data){
                                                        // alert("came in the call back function"+data);
                                                        // alert(" result :  "+data);
                                                        listOfCategories = data;
                                                           // alert("1");
                                                           // alert("data is : "+data);
                                                        // alert("list of categories is : "+listOfCategories);
                                                        var parsedListOfCategories = listOfCategories.split(",");
                                                        for(var i=0;i<parsedListOfCategories.length;i++){
                                                                  // alert(":"+parsedListOfCategories[i]+":");
                                                                 $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                 // alert($(ddl).val());
                                                        }
                                                }   
                                                    }); 

                 

                    // displyaing of the profile pic for the logged out user 
                    $("#waitSymbol").show();
                    jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getUserData/"+userName,
                            dataType: 'text',
                            success: function(data){
                            /* getElement("profilePic").src = "";
                             getElement("profilePic").src  = data;*/
                             // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                             testString = "Book1IntitialBook";
                             $("#waitSymbol").hide();
                    }   
                    });

                    // get element by id method
                      function getElement(id) { return document.getElementById(id); } 

                    // displaying categories for the logged out user , displaying books based on category
                         $("#dropDown").change(function(){
                        var selectedDropDownValue = this.value;
                        var ddlBooks = "#dropDownBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+selectedDropDownValue,
                                            dataType: 'text',
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   

                                            }); 
                                 // code for general reset
                                                                                             $("#divTextArea").val("");
                                                                                             $("#newTopicInputId").val("");
                                                                                             $("#newBookId").val("");
                                                                                             $("#topicDropDown").val("1");

                  });         

                   
                    // end of displaying categories for the logged out user


                    // to show book for reading on clicking on the books in the drop down list
                    $("#dropDownBooks").change(function(){
                         
                        var bookName = this.value;
                      
                        // alert("book name is : "+bookName);
                        // var userName = username[1];
                        // alert("username is : "+userName);
                        var categoryName = $("#dropDown").val();
                        // alert("category is : "+categoryName);

                        var bookSplitName = bookName.split("-");
                        var bookTrimmedName = bookSplitName[0].trim();
                        // alert("book trimmed name is :"+bookTrimmedName+":");


                        // $("#bookLayout").show(); 
                                if(bookName.indexOf("quick-view") > 0 ){
                                        // alert("matched");
                                
                                // intitalizing wait
                                // $("#waitSymbol").show();
                                // alert("category name is : "+categoryName);

                                if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDown").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                }

                                $("#waitSymbol").show();
                                jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                        // alert("data received is : "+data);

                                         history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                         var splittedData = data.split("&&**");
                                         var receivedTopicFromDatabaseArray = splittedData[1];
                                         var pageContent = splittedData[0];
                                         // parsing page content to remove pre tags

                                            var pageContetnsWithPreTage = pageContent.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         // end of parsing of page contents to remove pre tags
                                         var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                         var topicName = topicNameArray[1];
                                 $("#newTopicInputId").val(topicName);
                                  // alert("data quick view"+pageContentWithoutPreValue);
                                     $("#divTextArea").text(pageContentWithoutPreValue);
                                     $("#topicDropDown").val("1");
                                     $("#newBookId").val(bookTrimmedName);

                                     // closing wait symbol
                                    $("#waitSymbol").hide();

                                }   
                                    });

                                    }

                                    else{

                                        // alert("category name is :"+categoryName);
                                         if(categoryName=="Please select"){
                                          // alert("matched");
                                        categoryName = $("#dropDown").text();

                                         var categoryParsed = categoryName.split("\n");
                                           // alert("topic number is :"+categoryParsed[1]+":");
                                          categoryName = categoryParsed[1].trim();
                                          // alert("category name is ="+categoryName+"=");
                                        }
                                            $("#waitSymbol").show();
                                            jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                         $("#bookLayout").show(); 
                                         $("#bookTitleWhileRead").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                              // parsing page content to remove pre tags
                                              
                                            var pageContetnsWithPreTage = data.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                            // alert("data full view"+pageContentWithoutPreValue);
                                             $("#divTextAreaForRead").text(pageContentWithoutPreValue);
                                             $("#topicDropDownWhileRead").val("1");
                                             $("#topicFetchedWhileRead").text("");
                                             $("#waitSymbol").hide();
                                            
                                }   
                                    });

                                    }
                       

                  });      // end to show book for reading on clicking on the books in the drop down list    

                  
                  // after the book gets rendered as above , the topic wise content of the books to be fetched in write mode for logged out user first

                 $("#topicDropDown").change(function(){

                  // alert("please confirm selection of category to read other topics of this book");
                var topicNumber = this.value;
                // alert("topic number is : "+topicNumber);
                var categoryName = $("#dropDown").text();
                // alert($("#dropDown").val());

                var categoryParsed = categoryName.split("\n");
                 // alert("topic number is :"+categoryParsed[1]+":");
                 categoryName = categoryParsed[1].trim();
                 // alert(categoryName);

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = $("#dropDown").val();

                 }

                var bookName = $("#newBookId").val();
                 // alert("topic number is : "+bookName);
                var bookId = bookName+":"+topicNumber;
                 // alert("topic number is : "+bookId);


                 if(($("#dropDown").val()!="Please select")&&($("#dropDown").text()!="Please select")){
                  // alert("matched here 1");
                  categoryName = $("#dropDown").val();
                 }

                 // alert("category name is : "+categoryName);
                 // alert("book id is :"+bookId);

                        // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                        $("#waitSymbol").show();
                        jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                            dataType: 'text',
                            success: function(data){
                                // alert("came in the call back function"+data);
                                // alert(" book details are :  "+data);
                                // resetting the editor after the save action 
                                // alert("data received is : "+data.length);

                                if(data.length>0)
                                {
                                 var splittedData = data.split("&&**");
                                 var receivedTopicFromDatabaseArray = splittedData[1];
                                 var pageContent = splittedData[0];
                                 var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                 var topicName = topicNameArray[1];
                         $("#newTopicInputId").val(topicName);
                         // parsing page content to remove pre tags
                                    var pageContetnsWithPreTage = pageContent.split("pre>");
                                    var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                    var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                    var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             $("#divTextArea").text(pageContentWithoutPreValue);
                             // $("#topicDropDown").val("1");
                             // $("#newBookId").val(bookTrimmedName);
                             $("#waitSymbol").hide();
                           }
                           else{
                            // alert("topic doesn't exist");
                             $("#divTextArea").text(" No contents for this topic ! . It's empty .");
                              $("#newTopicInputId").val("");
                              $("#waitSymbol").hide();
                           }

                        }   // end of success call back
                            });

                  });   

                  // end of toic wise reading of book in write mode


                     // $('#dropDown').find("option[value='ds-algo']").attr("selected",true);
                     // $('#dropDown').val("ds-algo");
                     $('#dropDown :selected').text(categoryName);
                     // $('#dropDown :selected').value(categoryName);

                     // alert(userName+categoryName);

                     // displaying books in book drop down when the category gets pre selected for certain logged out user
                        var ddlBooks = "#dropDownBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+categoryName,
                                            dataType: 'text',
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   
                                            }); 
                     // end of displaying of books for pre selected categories


                     // start of topic wise contents display while read mode for logged out user

                            $("#topicDropDownWhileRead").change(function(){
                            // alert(" Value of selected book title : "+this.value); 
                            var topicNumber = this.value;

                            // alert("book name is : "+bookName);
                            // var userName = username[1];
                            var bookNameAndCategoryName = $("#bookTitleWhileRead").text();
                            var bookName = bookNameAndCategoryName.split("(");
                            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
                            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
                            // alert("book name is ="+bookNameWithoutLabel+"=");
                            // alert("category name is ="+categoryName+"=");
                              if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDown").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                  // alert("category name is ="+categoryName+"=");
                                }
                            

                            var bookId = bookNameWithoutLabel+":"+topicNumber;

                                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                                    $("#waitSymbol").show();
                                    jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                                        dataType: 'text',
                                        success: function(data){
                                            // alert("came in the call back function"+data);
                                            // alert(" book details are :  "+data);
                                            // resetting the editor after the save action 
                                            // alert("data received is : "+data);
                                            if(data.length>0){
                                             var splittedData = data.split("&&**");
                                             var receivedTopicFromDatabaseArray = splittedData[1];
                                             var pageContent = splittedData[0];
                                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                             var topicName = topicNameArray[1];
                                     $("#topicFetchedWhileRead").text("");
                                     $("#topicFetchedWhileRead").text(" Topic Name : "+topicName);
                                     // parsing page content to remove pre tags
                                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         $("#divTextAreaForRead").text(pageContentWithoutPreValue);
                                         // $("#topicDropDown").val("1");
                                         // $("#newBookId").val(bookTrimmedName);
                                         $("#waitSymbol").hide();
                                       }
                                         else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForRead").text(" No contents for this topic ! . It's empty .");
                                             $("#waitSymbol").hide();
                                             $("#topicFetchedWhileRead").text("");
                                             $("#topicFetchedWhileRead").text(" Topic Name : ");
                                           }

                                    }   
                                        });


                      });        

                     // end of topic wise contetns display while read mode for logged out user 


                     // start of method for closing of read view for logged out user

                    $("#closeButton").click(function(){
                            $("#bookLayout").hide();
                    });
                     // end of method for closing of read vierw for logged out user


                    
                   
                  

               $("#searchThinkers").keypress(function(e) {
                 // $("#newCategoryInputId").val("");
                  e.stopImmediatePropagation();
                  if(e.which == 13) {
                   
                    // e.stop();
                    // e.preventDefault();
                    // var userName ;
                   var userName= $("#searchThinkers").val();


                   // great new , variable 'availableTags' from other script holder is showing up it's value over here inside the current script 
                   // alert(availableTags);
                  
                  /* var newUrl =  "http://localhost:8080/portal/library/"+keyInput;

                     var userMatch = "false";


                   for(var i=0;i<availableTags.length;i++){
                   
                    if((availableTags[i]==keyInput)){
                      
                       var objectEl = document.getElementById('contentOfThinkersTab');
                        
                       objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"');
                       userMatch = "true";
                      break;
                    }                
                   }

                   if(userMatch=="false"){
                    alert(" User not found ! ");
                    
                   }*/


               /* var currentUrlParsed = currentUrl.split("library"); 
                var userCategoryBookParsed = currentUrlParsed[1].split("/");
                var userName = userCategoryBookParsed[1];
                var categoryName = userCategoryBookParsed[2];
                var bookTrimmedName = userCategoryBookParsed[3];
*/
                  // alert(userName);

                   $("#divTextAreaThinkers").text("");
                   $("#newTopicInputIdThinkers").val("");
                   $("#newBookIdThinkers").val("");
                   $("#topicDropDownThinkers").val("1");

                 $("#welcomeTextThinkers").text("Thinker :  "+userName);  


                 // disabling some of the buttons for the logged out user
                 // $("#logoutPlaceHolder").hide();
                  // disabling the logout button , enabling of login button should come here itself by writing one more  span in html
                 // by keeing that hidden and showing for logged user entrance .
                 // alert("here");
                  $("#newBookButtonIdThinkers").hide(); // disabling create / update book button for logged out user  , working presently on this .
                  $("#newCategoryInputButtonIdThinkers").hide();
                  $("#newCategoryInputIdThinkers").hide();
                  // $("textarea").prop("readonly","true");
                  $("#newBookIdThinkers").prop("readonly","true");

                  $("#waitSymbolThinkers").hide();

                  // zones hiding 
                  // $("#zones").hide();


                  
                
                  // hide register/login place holder
                   $("#registerPlaceHolderThinkers").hide();
                    var firstVariableForDropdownThinkers = "Please select";
                     $("#dropDownThinkers").empty();
                      $("#dropDownThinkers").append('<option value="' + firstVariableForDropdownThinkers + '">' + firstVariableForDropdownThinkers + "</option>'");

                  // resetting the page for new book
                   // resetCode
                                                                                       


                  

                   // alert($("#dropDown").val());
                   // alert("category name is : "+categoryName);
                   // $("#dropDown :selected").text(categoryName).attr("selected", "selected"); // setting the category on landing of logged out user.
                   // end of disabling of buttons for the logged out user 

                // $("#waitSymbol").show();

                // getting book details for guest
                /*jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            // alert("categoryname is : "+categoryName);
                            if(categoryName==null){
                              // alert("matched here"); 
                             }
                             else{
                               history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                             }
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputId").val(topicName);
                         $("#divTextArea").text(pageContentWithoutPreValue);
                         $("#topicDropDown").val("1");
                         $("#newBookId").val(bookTrimmedName);

                         // hiding the wait button
                        // $("#waitSymbol").hide();

                    }   
                        });*/

                    // displaying the list of categories for the logged out user
                    var listOfCategories = "";
                    var ddl = "#dropDownThinkers";
                    var ddlBooks = "#dropDownBooksThinkers";
                                    jQuery.ajax({
                                                    url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+userName,
                                                    dataType: 'text',
                                                    success: function(data){
                                                        // alert("came in the call back function"+data);
                                                        // alert(" result :  "+data);
                                                        listOfCategories = data;
                                                           // alert("1");
                                                           // alert("data is : "+data);
                                                        // alert("list of categories is : "+listOfCategories);
                                                        var parsedListOfCategories = listOfCategories.split(",");
                                                        for(var i=0;i<parsedListOfCategories.length;i++){
                                                                  // alert(":"+parsedListOfCategories[i]+":");
                                                                 $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                 // alert($(ddl).val());
                                                        }
                                                }   
                                                    }); 

                 

                    // displyaing of the profile pic for the logged out user 
                    $("#waitSymbolThinkers").show();
                    jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getUserData/"+userName,
                            dataType: 'text',
                            success: function(data){
                             getElement("profilePicThinkers").src = "";
                             getElement("profilePicThinkers").src  = data;
                             // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                             testString = "Book1IntitialBook";
                             $("#waitSymbolThinkers").hide();
                    }   
                    });

                    // get element by id method
                      function getElement(id) { return document.getElementById(id); } 

                    // displaying categories for the logged out user , displaying books based on category
                         $("#dropDownThinkers").change(function(){
                        var selectedDropDownValue = this.value;
                        var ddlBooks = "#dropDownBooksThinkers";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                             // $(ddlBooks).empty();
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+selectedDropDownValue,
                                            dataType: 'text',
                                            async:false,
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        $(ddlBooks).empty();
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                      
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   

                                            }); 
                                 // code for general reset
                                                                                             $("#divTextAreaThinkers").text("");
                                                                                             $("#newTopicInputIdThinkers").val("");
                                                                                             $("#newBookIdThinkers").val("");
                                                                                             $("#topicDropDownThinkers").val("1");

                  });         

                   
                    // end of displaying categories for the logged out user


                    // to show book for reading on clicking on the books in the drop down list
                    $("#dropDownBooksThinkers").change(function(){
                         
                        var bookName = this.value;
                      
                        // alert("book name is : "+bookName);
                        // var userName = username[1];
                        // alert("username is : "+userName);
                        var categoryName = $("#dropDownThinkers").val();
                        // alert("category is : "+categoryName);

                        var bookSplitName = bookName.split("-");
                        var bookTrimmedName = bookSplitName[0].trim();
                        // alert("book trimmed name is :"+bookTrimmedName+":");


                        // $("#bookLayout").show(); 
                                if(bookName.indexOf("quick-view") > 0 ){
                                        // alert("matched");
                                
                                // intitalizing wait
                                // $("#waitSymbol").show();
                                // alert("category name is : "+categoryName);

                                if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownThinkers").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                }

                                $("#waitSymbolThinkers").show();
                                jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                        // alert("data received is : "+data);

                                         // history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                         var splittedData = data.split("&&**");
                                         var receivedTopicFromDatabaseArray = splittedData[1];
                                         var pageContent = splittedData[0];
                                         // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = pageContent.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         // end of parsing of page contents to remove pre tags
                                         var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                         var topicName = topicNameArray[1];
                                 $("#newTopicInputIdThinkers").val(topicName);
                                     $("#divTextAreaThinkers").text(pageContentWithoutPreValue);
                                     $("#topicDropDownThinkers").val("1");
                                     $("#newBookIdThinkers").val(bookTrimmedName);

                                     // closing wait symbol
                                    $("#waitSymbolThinkers").hide();

                                }   
                                    });

                                    }

                                    else{

                                        // alert("category name is :"+categoryName);
                                         if(categoryName=="Please select"){
                                          // alert("matched");
                                        categoryName = $("#dropDownThinkers").text();

                                         var categoryParsed = categoryName.split("\n");
                                           // alert("topic number is :"+categoryParsed[1]+":");
                                          categoryName = categoryParsed[1].trim();
                                          // alert("category name is ="+categoryName+"=");
                                        }
                                            $("#waitSymbolThinkers").show();
                                            jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                         $("#bookLayoutThinkers").show(); 
                                         $("#bookTitleWhileReadThinkers").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                              // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = data.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                             $("#divTextAreaForReadThinkers").text(pageContentWithoutPreValue);
                                             $("#topicDropDownWhileReadThinkers").val("1");
                                             $("#topicFetchedWhileReadThinkers").text("");
                                             $("#waitSymbolThinkers").hide();
                                              $("#newBookIdThinkers").val(bookTrimmedName);
                                            
                                }   
                                    });

                                    }
                       

                  });      // end to show book for reading on clicking on the books in the drop down list    

                  
                  // after the book gets rendered as above , the topic wise content of the books to be fetched in write mode for logged out user first

                 $("#topicDropDownThinkers").change(function(){

                  // alert("please confirm selection of category to read other topics of this book");
                var topicNumber = this.value;
                // alert("topic number is : "+topicNumber);
                var categoryName = $("#dropDownThinkers").val();
               /* // alert($("#dropDown").val());

                var categoryParsed = categoryName.split("\n");
                 // alert("topic number is :"+categoryParsed[1]+":");
                 categoryName = categoryParsed[1].trim();
                 // alert(categoryName);

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = $("#dropDownThinkers").val();

                 }*/

                var bookName = $("#newBookIdThinkers").val();
                 // alert("topic number is : "+bookName);
                var bookId = bookName+":"+topicNumber;
                 // alert("topic number is : "+bookId);


                /* if(($("#dropDownThinkers").val()!="Please select")&&($("#dropDownThinkers").text()!="Please select")){
                  // alert("matched here 1");
                  categoryName = $("#dropDownThinkers").val();
                 }*/
                 // alert("hello");
                 // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                
                        
                        $("#waitSymbolThinkers").show();
                        jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                            dataType: 'text',
                            success: function(data){
                               
                                if(data.length>0)
                                {
                                 var splittedData = data.split("&&**");
                                 var receivedTopicFromDatabaseArray = splittedData[1];
                                 var pageContent = splittedData[0];
                                 var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                 var topicName = topicNameArray[1];
                         $("#newTopicInputIdThinkers").val(topicName);
                         // parsing page content to remove pre tags
                                    var pageContetnsWithPreTage = pageContent.split("pre>");
                                    var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                    var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                    var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             $("#divTextAreaThinkers").text(pageContentWithoutPreValue);
                            
                             $("#waitSymbolThinkers").hide();
                           }
                           else{
                            // alert("topic doesn't exist");
                             $("#divTextAreaThinkers").text(" No contents for this topic ! . It's empty .");
                              $("#newTopicInputIdThinkers").val("");
                              $("#waitSymbolThinkers").hide();
                           }

                        }   // end of success call back
                            });

                  });   

                  // end of toic wise reading of book in write mode

                     // $('#dropDownThinkers :selected').text(categoryName);
                     // $('#dropDown :selected').value(categoryName);

                     // alert(userName+categoryName);

                     // displaying books in book drop down when the category gets pre selected for certain logged out user
                        var ddlBooks = "#dropDownBooksThinkers";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                       

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+categoryName,
                                            dataType: 'text',
                                            success: function(data){
                                               
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   
                                            }); 
                     // end of displaying of books for pre selected categories


                     // start of topic wise contents display while read mode for logged out user

                            $("#topicDropDownWhileReadThinkers").change(function(){
                            // alert(" Value of selected book title : "+this.value); 
                            var topicNumber = this.value;

                            
                            /*var bookNameAndCategoryName = $("#bookTitleWhileReadThinkers").text();
                            var bookName = bookNameAndCategoryName.split("(");
                            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
                            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
                            
                              if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownThinkers").text();

                                 var categoryParsed = categoryName.split("\n");
                                   
                                  categoryName = categoryParsed[1].trim();
                                 
                                }*/

                                  var categoryName = $("#dropDownThinkers").val();
                                  // var bookName = $("#dropDownBooksThinkers").val();
                                  var bookName =  $("#newBookIdThinkers").val();
                            

                            var bookId = bookName+":"+topicNumber;

                              // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                                    $("#waitSymbolThinkers").show();
                                    jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                                        dataType: 'text',
                                        success: function(data){
                                            
                                            if(data.length>0){
                                             var splittedData = data.split("&&**");
                                             var receivedTopicFromDatabaseArray = splittedData[1];
                                             var pageContent = splittedData[0];
                                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                             var topicName = topicNameArray[1];
                                     $("#topicFetchedWhileReadThinkers").text("");
                                     $("#topicFetchedWhileReadThinkers").text(" Topic Name : "+topicName);
                                     // parsing page content to remove pre tags
                                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         $("#divTextAreaForReadThinkers").text(pageContentWithoutPreValue);
                                         // $("#topicDropDown").val("1");
                                         // $("#newBookId").val(bookTrimmedName);
                                         $("#waitSymbolThinkers").hide();
                                       }
                                         else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForReadThinkers").text(" No contents for this topic ! . It's empty .");
                                             $("#waitSymbolThinkers").hide();
                                             $("#topicFetchedWhileReadThinkers").text("");
                                             $("#topicFetchedWhileReadThinkers").text(" Topic Name : ");
                                           }

                                    }   
                                        });


                      });        

                     // end of topic wise contetns display while read mode for logged out user 


                     // start of method for closing of read view for logged out user

                    $("#closeButtonThinkers").click(function(){
                            $("#bookLayoutThinkers").hide();
                    });


                     // end of method for closing of read vierw for logged out user
                      // return false;
                      // e.die();
                } // end of search hit button case 
             
            });
            // end of search thinkers funcionality


              // search books functionality
            $("#searchBooks").keypress(function(e) {
                 // $("#newCategoryInputId").val("");
                   e.stopImmediatePropagation();
                   if(e.which == 13) {
                   var bookNameEntered = $("#searchBooks").val();
                   

                   
                    jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getUserNameAndCategoryFromDistinctBookName/"+bookNameEntered,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                           
                            // data = data.substring(1,data.length);
                             // alert(" userList :  "+data);
                               var bookNameEntered = $("#searchBooks").val();
                           var userNameAndCategorySplittedArray = data.split(",");
                           var userNameFetched = userNameAndCategorySplittedArray[0];
                           var categoryFetched = userNameAndCategorySplittedArray[1];


                                
                  /* var newUrl =  "http://localhost:8080/portal/library/"+keyInput;

                     var userMatch = "false";
                   for(var i=0;i<availableTags.length;i++){
                   
                    if((availableTags[i]==keyInput)){
                      
                       var objectEl = document.getElementById('contentOfBooksTab');
                        
                       objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"');
                       userMatch = "true";
                      break;
                    }                
                   }

                   if(userMatch=="false"){
                    alert(" User not found ! ");
                    
                   }*/


               /* var currentUrlParsed = currentUrl.split("library"); 
                var userCategoryBookParsed = currentUrlParsed[1].split("/");
                var userName = userCategoryBookParsed[1];
                var categoryName = userCategoryBookParsed[2];
                var bookTrimmedName = userCategoryBookParsed[3];
*/
                  // alert(userName);

                   $("#divTextAreaBooks").text("");
                   $("#newTopicInputIdBooks").val("");
                   $("#newBookIdBooks").val("");
                   $("#topicDropDownBooks").val("1");

                 $("#welcomeTextBooks").text("Thinker :  "+userNameFetched);  


                 // disabling some of the buttons for the logged out user
                 //
                  // disabling the logout button , enabling of login button should come here itself by writing one more  span in html
                 // by keeing that hidden and showing for logged user entrance .
                 // alert("here");
                  $("#newBookButtonIdBooks").hide(); // disabling create / update book button for logged out user  , working presently on this .
                  $("#newCategoryInputButtonIdBooks").hide();
                  $("#newCategoryInputIdBooks").hide();
                  $("textarea").prop("readonly","true");
                  $("#newBookIdBooks").prop("readonly","true");

                  $("#waitSymbolBooks").hide();

                  // zones hiding 
                  // $("#zones").hide();


                  
                
                  // hide register/login place holder
                   $("#registerPlaceHolderBooks").hide();
                    // $("#logoutPlaceHolder").hide();
                    var firstVariableForDropdownBooks = "Please select";
                     $("#dropDownCategoryBooks").empty();
                      $("#dropDownCategoryBooks").append('<option value="' + firstVariableForDropdownBooks + '">' + firstVariableForDropdownBooks + "</option>'");

                  // resetting the page for new book
                   // resetCode
                                                                                       


                  

                   // alert($("#dropDown").val());
                   // alert("category name is : "+categoryName);
                   // $("#dropDown :selected").text(categoryName).attr("selected", "selected"); // setting the category on landing of logged out user.
                   // end of disabling of buttons for the logged out user 

                // $("#waitSymbol").show();

                // getting book details for guest
                jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryFetched+"/"+bookNameEntered,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            // alert("categoryname is : "+categoryName);
                            if(categoryFetched==null){
                              // alert("matched here"); 
                             }
                             else{
                               /*history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);*/
                             }
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputIdBooks").val(topicName);
                         $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                         $("#topicDropDownBooks").val("1");
                         $("#newBookIdBooks").val(bookNameEntered);

                         // hiding the wait button
                        // $("#waitSymbol").hide();

                    }   
                        });

                    // displaying the list of categories for the logged out user
                    var listOfCategories = "";
                    var ddl = "#dropDownCategoryBooks";
                    var ddlBooks = "#dropDownBooksBooks";
                                    jQuery.ajax({
                                                    url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+userNameFetched,
                                                    dataType: 'text',
                                                    success: function(data){
                                                        // alert("came in the call back function"+data);
                                                        // alert(" result :  "+data);
                                                        listOfCategories = data;
                                                           // alert("1");
                                                           // alert("data is : "+data);
                                                        // alert("list of categories is : "+listOfCategories);
                                                        var parsedListOfCategories = listOfCategories.split(",");
                                                        for(var i=0;i<parsedListOfCategories.length;i++){
                                                                  // alert(":"+parsedListOfCategories[i]+":");
                                                                 $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                 // alert($(ddl).val());
                                                        }
                                                }   
                                                    }); 

                 

                    // displyaing of the profile pic for the logged out user 
                    $("#waitSymbolBooks").show();
                    jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getUserData/"+userNameFetched,
                            dataType: 'text',
                            success: function(data){
                             getElement("profilePicBooks").src = "";
                             // console.log(data);
                             getElement("profilePicBooks").src  = data;
                             // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                             testString = "Book1IntitialBook";
                             $("#waitSymbolBooks").hide();
                    }   
                    });

                    // get element by id method
                      function getElement(id) { return document.getElementById(id); } 

                    // displaying categories for the logged out user , displaying books based on category
                         $("#dropDownCategoryBooks").change(function(){
                        var selectedDropDownValue = this.value;
                        var ddlBooks = "#dropDownBooksBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userNameFetched+"/"+selectedDropDownValue,
                                            dataType: 'text',
                                             async:false,
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   

                                            }); 
                                 // code for general reset
                                                                                             $("#divTextAreaBooks").text("");
                                                                                             $("#newTopicInputIdBooks").val("");
                                                                                             $("#newBookIdBooks").val("");
                                                                                             $("#topicDropDownBooks").val("1");

                  });         

                   
                    // end of displaying categories for the logged out user


                    // to show book for reading on clicking on the books in the drop down list
                    $("#dropDownBooksBooks").change(function(){
                         
                        var bookName = this.value;
                      
                        // alert("book name is : "+bookName);
                        // var userName = username[1];
                        // alert("username is : "+userName);
                        var categoryName = $("#dropDownCategoryBooks").val();
                        // alert("category is : "+categoryName);

                        var bookSplitName = bookName.split("-");
                        var bookTrimmedName = bookSplitName[0].trim();
                        // alert("book trimmed name is :"+bookTrimmedName+":");


                        // $("#bookLayout").show(); 
                                if(bookName.indexOf("quick-view") > 0 ){
                                        // alert("matched");
                                
                                // intitalizing wait
                                // $("#waitSymbol").show();
                                // alert("category name is : "+categoryName);

                                if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownCategoryBooks").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                }

                                $("#waitSymbolBooks").show();
                                jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                        // alert("data received is : "+data);

                                         // history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                         var splittedData = data.split("&&**");
                                         var receivedTopicFromDatabaseArray = splittedData[1];
                                         var pageContent = splittedData[0];
                                         // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = pageContent.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         // end of parsing of page contents to remove pre tags
                                         var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                         var topicName = topicNameArray[1];
                                 $("#newTopicInputIdBooks").val(topicName);
                                     $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                                     $("#topicDropDownBooks").val("1");
                                     $("#newBookIdBooks").val(bookTrimmedName);

                                     // closing wait symbol
                                    $("#waitSymbolBooks").hide();

                                }   
                                    });

                                    }

                                    else{

                                        // alert("category name is :"+categoryName);
                                         if(categoryName=="Please select"){
                                          // alert("matched");
                                        categoryName = $("#dropDownCategoryBooks").text();

                                         var categoryParsed = categoryName.split("\n");
                                           // alert("topic number is :"+categoryParsed[1]+":");
                                          categoryName = categoryParsed[1].trim();
                                          // alert("category name is ="+categoryName+"=");
                                        }
                                            $("#waitSymbolBooks").show();
                                            jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                         $("#bookLayoutBooks").show(); 
                                         $("#bookTitleWhileReadBooks").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                              // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = data.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                             $("#divTextAreaForReadBooks").text(pageContentWithoutPreValue);
                                             $("#topicDropDownWhileReadBooks").val("1");
                                             $("#topicFetchedWhileReadBooks").text("");
                                               $("#newBookIdBooks").val(bookTrimmedName);
                                             $("#waitSymbolBooks").hide();
                                            
                                }   
                                    });

                                    }
                       

                  });      // end to show book for reading on clicking on the books in the drop down list    

                  
                  // after the book gets rendered as above , the topic wise content of the books to be fetched in write mode for logged out user first

                 $("#topicDropDownBooks").change(function(){

                  // alert("please confirm selection of category to read other topics of this book");
                var topicNumber = this.value;
                // alert("topic number is : "+topicNumber);
                var categoryName = $("#dropDownCategoryBooks").val();
               /* // alert($("#dropDown").val());

                var categoryParsed = categoryName.split("\n");
                 // alert("topic number is :"+categoryParsed[1]+":");
                 categoryName = categoryParsed[1].trim();
                 // alert(categoryName);

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = $("#dropDownBooks").val();

                 }*/

                  if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = categoryFetched;

                 }

                var bookName = $("#newBookIdBooks").val();
                 // alert("topic number is : "+bookName);
                var bookId = bookName+":"+topicNumber;
                 // alert("topic number is : "+bookId);


                /* if(($("#dropDownBooks").val()!="Please select")&&($("#dropDownBooks").text()!="Please select")){
                  // alert("matched here 1");
                  categoryName = $("#dropDownBooks").val();
                 }*/
                 // alert("hello");
                 // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);



                        // here one ajax query will be written to check if the thinker is in the paid list of the corresponding unique book name

                
                        
                        $("#waitSymbolBooks").show();
                        jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userNameFetched+"/"+categoryName+"/"+bookId,
                            dataType: 'text',
                            success: function(data){
                               
                                if(data.length>0)
                                {
                                 var splittedData = data.split("&&**");
                                 var receivedTopicFromDatabaseArray = splittedData[1];
                                 var pageContent = splittedData[0];
                                 var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                 var topicName = topicNameArray[1];
                         $("#newTopicInputIdBooks").val(topicName);
                         // parsing page content to remove pre tags
                                    var pageContetnsWithPreTage = pageContent.split("pre>");
                                    var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                    var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                    var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                            
                             $("#waitSymbolBooks").hide();
                           }
                           else{
                            // alert("topic doesn't exist");
                             $("#divTextAreaBooks").text(" No contents for this topic ! . It's empty .");
                              $("#newTopicInputIdBooks").val("");
                              $("#waitSymbolBooks").hide();
                           }

                        }   // end of success call back
                            });

                  });   

                  // end of toic wise reading of book in write mode

                     // $('#dropDownBooks :selected').text(categoryName);
                     // $('#dropDown :selected').value(categoryName);

                     // alert(userName+categoryName);

                     // displaying books in book drop down when the category gets pre selected for certain logged out user
                        var ddlBooks = "#dropDownBooksBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                       

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+categoryName,
                                            dataType: 'text',
                                            success: function(data){
                                               
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   
                                            }); 
                     // end of displaying of books for pre selected categories


                     // start of topic wise contents display while read mode for logged out user

                            $("#topicDropDownWhileReadBooks").change(function(){
                            // alert(" Value of selected book title : "+this.value); 
                            var topicNumber = this.value;

                            
                            /*var bookNameAndCategoryName = $("#bookTitleWhileReadBooks").text();
                            var bookName = bookNameAndCategoryName.split("(");
                            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
                            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
                            
                              if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownBooks").text();

                                 var categoryParsed = categoryName.split("\n");
                                   
                                  categoryName = categoryParsed[1].trim();
                                 
                                }*/

                                  var categoryName = $("#dropDownCategoryBooks").val();
                                  // var bookName = $("#dropDownBooksBooks").val();
                                   var bookName =  $("#newBookIdBooks").val();
                            

                            var bookId = bookName+":"+topicNumber;

                              // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                                    $("#waitSymbolBooks").show();
                                    jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userNameFetched+"/"+categoryName+"/"+bookId,
                                        dataType: 'text',
                                        success: function(data){
                                            
                                            if(data.length>0){
                                             var splittedData = data.split("&&**");
                                             var receivedTopicFromDatabaseArray = splittedData[1];
                                             var pageContent = splittedData[0];
                                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                             var topicName = topicNameArray[1];
                                     $("#topicFetchedWhileReadBooks").text("");
                                     $("#topicFetchedWhileReadBooks").text(" Topic Name : "+topicName);
                                     // parsing page content to remove pre tags
                                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         $("#divTextAreaForReadBooks").text(pageContentWithoutPreValue);
                                         // $("#topicDropDown").val("1");
                                         // $("#newBookId").val(bookTrimmedName);
                                         $("#waitSymbolBooks").hide();
                                       }
                                         else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForReadBooks").text(" No contents for this topic ! . It's empty .");
                                             $("#waitSymbolBooks").hide();
                                             $("#topicFetchedWhileReadBooks").text("");
                                             $("#topicFetchedWhileReadBooks").text(" Topic Name : ");
                                           }

                                    }   
                                        });


                      });        

                     // end of topic wise contetns display while read mode for logged out user 


                     // start of method for closing of read view for logged out user

                    $("#closeButtonBooks").click(function(){
                            $("#bookLayoutBooks").hide();
                    });


                     // end of method for closing of read vierw for logged out user
                      // return false;
                      // e.die();
                   


                    }   
                        }); 



                   

                }
              /*if(keyInput.length > 12 ){
                alert("We request you to have category less than 12 characters");
                 $("#newCategoryInputId").val("");
              }*/
            });
            // end of search books funcionality


        } // endOfGuest use case , end of script for logged out user


        // alert("startOfThinker");
        var parameters = location.search.substring(1).split("&");
        var username = parameters[0].split("=");
        var password = parameters[1].split("=");
        var testString = "initial string";


        // hiding the register button for logged in user
        $("#registerPlaceHolder").hide();

        // search bar hidinng
        $("#searchThinkers").hide();

        // search books bar hiding
        $("#searchBooks").hide();
        
        // hide register/login place holder
        $("#registerPlaceHolder").hide();

        // alert("hello");


      $("#paymentButton").click(function (event) {   
          $("#agreeId").show();
          $("#agreementTextId").show();
          window.open("https://www.instamojo.com/@thoughtsbook");
      });


       $("#agreeId").click(function (event) {   
          var purposeCode =  $("#purposeOfPaymentCodeId").text();
          alert(purposeCode);
          jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/register/moveFromInboxToDatabase/"+purposeCode,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            alert(data);
                    }   
                        });
      });




        function getElement(id) { return document.getElementById(id); } // Get el by ID helper function


         


        // alert("username is : "+username[1]);
        // alert("username is : "+username[1]);


        // Following lines of code in succession without line gap is to fetch the list of categories and list of books from database
        // and then render it in the dropdown of categories and in the dropdown of books.
        var listOfCategories = "";
        var ddl = "#dropDown";
        var ddlBooks = "#dropDownBooks";
                        jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+username[1],
                                        dataType: 'text',
                                        success: function(data){
                                            // alert("came in the call back function"+data);
                                            // alert(" result :  "+data);
                                            listOfCategories = data;
                                               // alert("1");
                                               // alert("data is : "+data);
                                            // alert("list of categories is : "+listOfCategories);
                                            var parsedListOfCategories = listOfCategories.split(",");
                                            for(var i=0;i<parsedListOfCategories.length;i++){
                                                     $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                            }
                                    }   
                                        }); 


                        
        var value = "aparnesh";
        var name = "aparnesh";
        
   // $(ddl).append('<option value="' + value + '">' + name + "</option>'");
   $(ddlBooks).append('<option value="' + value + '">' + name + "</option>'");
   // end of relevant codes for appending categories list and book list to drop downs




        /*alert("username is : "+username[1]);*/
        // alert("password is . : "+password[1]);    
       var credentials =  username[1]+":"+password[1];
       // alert("credentials are : "+credentials);

         jQuery.ajax({
                url: "http://localhost:8080/portal/portal/login/"+credentials,
                dataType: 'text',
                        success: function(data){    
                // alert("came in the call back function"+data);
                if(data=="authenticated"){
                         // alert("authenticated");
                         // alert("user is : "+username[1])
                          // alert("password is . : "+password[1]); 
                           $("#welcomeText").text(" ");  
                         $("#welcomeText").text("("+username[1]+")");  
                         // here in future /library/username history api url should be placed
                          history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+username[1]);
                        
                }
                else{
                      // function getElement(id) { return document.getElementById(id); } 
                      // getElement("profilePic").src = "asdfsfdasfasdfasdfsadf";
                      // document.getElementById("profilePic") = " ";
                      // $("#profilePic").empty();
                      alert("Invalid credentials , Kingly re-login !");
                      javascript:window.history.back(1);
                }
        }   
        });

         $("#waitSymbol").show();
         jQuery.ajax({
                url: "http://localhost:8080/portal/portal/login/getUserData/"+username[1],
                dataType: 'text',
                success: function(data){
                 // getElement("profilePic").src = "";
                 // console.log(data);
                 // getElement("profilePic").src  = data;
                 // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                 testString = "Book1IntitialBook";
                 // alert("hello");
                 $("#waitSymbol").hide();
        }   
        });


      
         // create category on button function ends

function displayBook(nestedDivElementLeftForCategory,passedString){
        // alert("these books are being displayed !"+passedString);
                        nestedDivElementLeftForCategory.empty();

                        // iterate the logic to have multiple buttons with the name of the passed string . 
                        for(var i=0;i<3;i++){
                        var buttonElement = $("<button></button>");
                        // alert("passed string is : "+passedString);
                        buttonElement.text(passedString+i);
                        buttonElement.attr("style","color:black;font-family: cursive");
                        buttonElement.click(function(e){
                                $("#bookLayout").show(); 
                        });
                        nestedDivElementLeftForCategory.append(buttonElement);
                        }



                        // first alert string elements from a string array
                        // for(var i=0;i<3;i++){
                                // alert(i);
                        // }

        // return string1+"!!!!";
}

$("#closeButton").click(function(){
        $("#bookLayout").hide();
});



$("#newCategoryInputButtonId").click(function(){
        var categoryValue = $("#newCategoryInputId").val();
        jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/register/attachUserNameWithCategory/"+username[1]+"/"+categoryValue,
                                        dataType: 'text',
                                        success: function(data){
                                        // alert("came in the call back function"+data);
                                        alert(data);
                                       


                                 var listOfCategories = "";
                                                        var ddl = "#dropDown";
                                                        var ddlBooks = "#dropDownBooks";
                                                        var firstVariableForDropdown = "Please select";
                                                        var firstVariableForBookDropdown = "Please select book";

                                                                                              // code for general reset
                                                                                             $("#divTextArea").text("");
                                                                                             $("#newTopicInputId").val("");
                                                                                             $("#newBookId").val("");
                                                                                             $("#topicDropDown").val("1");
                                                                                             $(ddlBooks).empty();
                                                                                             $(ddlBooks).append('<option value="' + firstVariableForBookDropdown + '">' + firstVariableForBookDropdown + "</option>'");





                                                                        jQuery.ajax({
                                                                                        url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+username[1],
                                                                                        dataType: 'text',
                                                                                        success: function(data){
                                                                                            // alert("came in the call back function"+data);
                                                                                            // alert(" result :  "+data);
                                                                                            listOfCategories = data;
                                                                                            // alert("list of categories is : "+listOfCategories);
                                                                                            // alert("list of categories is : "+listOfCategories);
                                                                                            var parsedListOfCategories = listOfCategories.split(",");
                                                                                            $(ddl).empty();
                                                                                            $(ddl).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                                            for(var i=0;i<parsedListOfCategories.length;i++){
                                                                                                     $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                                            }

                                                                                            
                                                                                    }   
                                                                                        });   


                                }   
                                });


                                              

});



// start of newbook create button click code
$("#newBookButtonId").click(function(){

        // alert($("#dropDown").val());
        if($("#dropDown").val().trim() =="Please select".trim()){
          alert("Please select category from the drop down");
        }

        else{

        // alert("button clicked");
        // good source
        var newBookName = $("#newBookId").val();
        // alert("new book name is : "+newBookName);
        var user = username[1];
        // alert("username is : "+user);
        var categoryName = $("#dropDown").val();
        // alert("category name is : "+categoryName);
        // $("#divTextArea").css('white-space', 'pre-wrap');
        var topicContents = "<pre>"+$("#divTextArea")[0].innerText+"</pre>";
        // topicContents = "<pre>" + topicContents + "</pre>";
        // alert(" formatted topic contents are : "+topicContents);
        // alert("topic contents are : "+topicContents);
        var topicNumber = $("#topicDropDown").val();
        // alert("topic number : "+topicNumber);
        var topicName = $("#newTopicInputId").val();
        // alert("topic name is : "+topicName);
        var consolidateTopicNumberAndName = topicNumber + ":" + topicName;
        // alert("consolidateTopicNumberAndName"+consolidateTopicNumberAndName);
        var dataForPost = user+"nishugaurav"+categoryName+"nishugaurav"+newBookName+"nishugaurav"+consolidateTopicNumberAndName+"nishugaurav"+topicContents;

        var ddlBooks = "#dropDownBooks";
    var listOfBooks = "";
    var firstVariableForDropdown = "Please select book";


       
                         jQuery.ajax({
                                url: "http://localhost:8080/portal/portal/register/attachBookDetailsWithCategoryAndUserNameThroughPost",
                                type:"POST",
                                contentType: "text/plain",
                                data: dataForPost,
                                success: function(data){
                                // here , as part of the data received in callback should be the list of books as per the user id and cateogory
                                // which also includes the book which just recently got saved . 

                                alert(data);


                                jQuery.ajax({
                                url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+username[1]+"/"+categoryName,
                                dataType: 'text',
                                success: function(data){
                                    
                                                            listOfBooks = data;
                                                            
                                                            
                                                            var parsedListOfBooks = listOfBooks.split(",");
                                                            var parsedListOfBooks1=parsedListOfBooks.filter(function(itm,i,parsedListOfBooks){
                                                                    return i==parsedListOfBooks.indexOf(itm);
                                                                                });
                                                            $(ddlBooks).empty();
                                                            $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                            for(var i=1;i<parsedListOfBooks1.length;i++){

                                                                     $(ddlBooks).append('<option value="' + parsedListOfBooks1[i] + ' - ( full-view )">' + parsedListOfBooks1[i] + " - ( full-view )</option>'");
                                                                     $(ddlBooks).append('<option value="' + parsedListOfBooks1[i] + ' - ( create-mode )">' + parsedListOfBooks1[i] + "- ( create-mode )</option>'");
                                                            }
                                                    
                                                   
                            }   
                                }); 



                          // this part would update the price of the book in the table 'bookPaymentDetails'   
                          /* jQuery.ajax({
                                url: "http://localhost:8080/portal/portal/register/mapBookPriceToUniqueBookName/"+newBookName+"/"+$("#bookPrice").val(),
                                dataType: 'text',
                                success: function(data){
                                    
                                                           alert("response of mapping book price : "+data);
                                                    
                                                   
                            }   
                                }); */   


                         // code for screen clear
                         $("#divTextArea").text("");
                         $("#newTopicInputId").val("");
                         $("#newBookId").val("");
                         $("#topicDropDown").val("1");


                            }   
                            });



                        /**/
               }// end of else statemenet where category is selected for book creation / updation                                      

}); // end of new book create button click code




// adding functionality to append images to write zone

$("#addImageId").click(function(){
   
   var imageElement = $('<img id="dynamic">');
   // var img = $('<img id="dynamic">'); //Equivalent: $(document.createElement('img'))
   imageElement.attr('src', "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2ODApLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAqgEQAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+hZPiJ4U8E6f9k8P2xu7lVx5iLhXPq7nk/gPbivP/G3iW08TSWl1b2sVtcshNwEjKsHzzk5wwPUHGeea5ikFfMU8NCnLnV2+7PuudtGr4c16Xw3q8GoQwxTzQ5KCYEqDjGceoqtqmq3WtahPe3kzTXMzbnc9/wDAe1dJJ4MsLDwlZ6tf6k9tc3qsYLYxdcZwSQScHjnHcVyI5rWDhOTnHfa5QFj6mlyfU4pMUg46itRE0cMsscsiKzpGAXI/hBOBn8SKj3H1NG5lBAJCnqOxrZ8O6nYWVvqEd9CzGeExxSxxhnjJ4OMkDGCc8Z9xUSbirpXKSu7Ed/d6XPpNqlrazW9/GQssjy71kGCS3QYOT09APessMT34pKs3+mXOlTrDdRGKRo1kCnurAEH8jTSUdLiO58C/DKXxTY3ct6t1YFolksrgr+5fkg5yOe3T3rmfFOhHwxrlzpv2tLwwEZljGAcgHH15rS0X4jX2k+FdQ0UtJIkyoLaQSEG3IfLY+vNVPGPi9/FuoRv5Qt7eMbY0IG7kDJZh15FccFX9s+b4S1axn6Trt9odw01jcvbyOhRip4IIxyO/r7HBqkZGYkkkk8k1q6x4bfQjdRXl5brewMuLeNt/mIf4gw49ODzj074hfA4rpjyy96JDdi9c6hc3qwLPM0qwRiKMMfuoCSAPbk1FbzpFcRtKnmxqwLR7sbh3Ge2a1fBMOlXusPHrLpHY/Z5GMjybCpA4K+p9B3pfGOqaFqhs59JimtpFjEU0MkaqvyjAbIPJPf8ACpv7/s1F+vQOZWvc6j4iRWc+i6XcWE1hbxW0eH0+CcPIhc7s5/i7A+n0rzt7gnuaqmcelRtPV0qLpx5b3MpVb7HZaP8AErU9E0iexVhOGRUgM2GWAAkthSMEnOMmuTkuy7lieScntVOSfPGarvOefStoUIxbaW5m6kn1NBrsAZ6momvD64rOe6A6n8qha+VeprdQRk5mn9u96a16eSOaxpNQGcryKgk1EsvoPWrUCXURsPfY4JqrNqWDjJrEk1EY5bFVZNRUdzWqpmMqtjdOq4znkVXl1RgPvEDpXafBr4dQ+Phe6jetIbGzYKII+DM+MlSewHHT1r0Lxd4ItIfDUNu1rA0EcaxlEjw4x0II/i55PfvXBUxlKlV9lu+p006VSpDnT0Pn2bVCFOXPuCapTasQOCfzqp4nspdB1aa1kG0A7kz/ABIehrEa8LDrmvWjFSV0eROtKLaZtS6q3OWx+NU5dSYnqT7k1lNc4yc81A8+e+frWygcsqre7NSXUG5+bHbrVR7o4zk59zVB7rrUD3FaKBi6h9v+N38D6PGdKt7P7VqMUBR7+3yFWUAAZUMASTnOOnvzXl2elJTkjaVtqKXb0UZNfL0qfso2u36n2F7m9Y6Xr3juXFuGv3tIljCtIi+XGOAACRx9KydS0+40i9ltLpBHPGcOoYNg/UcVv2HjNtD8J3Gj2Nsbe7u3P2m7J+Zk6bVHbjv7n1rmZZpJn3yO0jYAy5ycDgU4c/M7pKPQptIbQOaM47Vpad4b1XVrZp7LT7i6gUkGSJCyg+5/GtG1FXbBNdDOoAywBOPc0xz5bMjAh1OCp7GmmZaqxHOkdff21t4Qg0m8sNSgutWO6R/KXzIthJAILDGRgggjPOaxtf8AEF34j1B7u8fLEkJGpO2NSSdq5PABJwKxGnANRmftUQo2d3q+5LqPoWzIF70sdyYJEkRtroQyn0I6VBp8LalqNtaIwR55ViUkE4JOM4AJPXsKl8Q6RcaBfz28yu8ccrQicxlUdlxu2569R+BB71raN+R7k3drkuo6zc6pdNc3lxJczsADJK25iAMDn6VUaZyMhWIxnOO1Zz3Pvj8a2LnxNrOieHxpE6SW9hdp5yCWLBdGKtlWIztJQdOOTVcnLZRSI5luyk1wT3pryuI/M2t5edu7HGfSsd9Rxkjn1rs/DnjvQIvCk2j6xpzyRI5ulMUrBp5/ugZH3AFJ9c4/CnU5qcU4xv6BFxk7N2EtvBmt3Oj3Gqm0+z2MMPnmac7A69tuepP+HrXMS3e09a6HwZ8UU8Pw6rFeF7myMDfY7C5Jli8zeCAR0988dD3NcFqetNf3s9wwjjaV2kKxLtRcnOAB0FKiqznKNRaLZiqTpqKcHqaTagATk1Vk1JjnnArDm1HGeaptqJPeu9UzhlXSNyW/3c7vaqsmohRwc/WsNr3Ofm4qtPe5B+Y1ooHM6x7Z8MPh1H4r0+XWdQkYWUTssdsgOZiBySw6AEj689K7rU9ANt4fitzBC0EcOzyioGVOOvvwOazP2X/Fa634fvtBdUSXT8yRnfzKshJOV9j3B/iFdj4yt7mxsirwyhHyvyjIPb8MivlMTVqfWnTl0enofR4aMHQU49VqfMHjLTl0a/zAGFrIMru7HuM1zMl8ecnn0rqfirqbi7htQcQAtJz1ZslTxjjG3FefG5z3r6ygnKmmz5fESUajUT3z9mL4iR6N4ql0G+uRBZ6mMQhwNv2joMntkZHucV7f8V9V0/w9orXEl7bCIITguQTj0x+VfEzak+jaTb/Z2EdxeI7vOo+YR7igQHqMlXzjqCBWJJdFgAWJA6AmvNrZYsRX9upW76b2OujmLw9P2bjc3/FGunWdcu7vzC6SP8p9FHAA+g4rHa4z0NUWuM96he49692MFFJI8adRybk+pfa5681C1xnvVI3JqJp81qomTkXHnHrUDznJqq03HWojL71agS5H1YWA6mt/wf4mtPC17LqElmby9RMWoY4jRj1Y9+K5UzY9qje49TXysqSqRcZbM+2U3F3RveIPE154jvBdX8olnC7dwGOMk9Pxpuk2UF/Be3FzerZQ2yAglN7SOTgKBke5z2ANc81x3qFrrHVuKtUko8sdCHO7uzSNz6muwufiKum+ErLRNCE1kf8AWXd3nbJJJ1IBHQf0AHrXnL3qDOW4otWm1G8jtrSJ7ieU7UjQZZj6AU50YTs57LUlTtojQmvHmleR2LO5LE+pNQm5xUWr6TrGhoJNQ027sUJwDcQsgJx05FYsmoEry2PatoxTV4mcp8r1Ou03xDDp+m6lay26XBukCozYBiYHO4HBPtgEViPfKM/NWHJfADlifYVXkv8ABHIwKuNJJtrqZyrXVjbfUucg9K6DxV8UNS8TWUVlIsMNkiRjyxEhYuqBS+/GctjnHbA7VyPiG90iO30z+y3mlma2DXbSNwJckFQMDAAAPU5zW98NPDOl+KLXXL3V70QWen2jTNFbSf6SMYO9UIwyjkHkckVlU9nGCrVFt5a72FGcpS9nF7nW/Au10nxLreqaXq1lHdRzWhkE0h2mEKRlgeoPPUenpmrPxE+JvgzxD4ebSha3/wBt0xWt9PnQq0eFwoYncMhgozkZHavD7rWRa3l0dNuLiK3fdGu5trtGT91sccjGR0rKlvTu+9+VJ4JTre2lJ9LLs+v37GTxjjDkSRuSaptzim3b3dvZQXUkbR21wWEUh6PtOGx+PGfr6Vzsly3Gc8/kahku2ICljhegr0uTscDqvqdmF0I+FHun1WYa4z4jshDlAgIBLP6kEkf7pz1Fc02oHnmstp/fmomuDnrVRptXu7mcqt+hoSXrFcdKga6OMbsVRa64x2qLzy7ADk9gK1UUYOdy61wRzmo2uOvNdro/wW8Rarpst5OYNLClcQ3hZZGDKGVsAHAIPfvniuB1S0udHvJLW7iaGZDgq38x7VEKlOo3GDvYupTqU0pTjZM2PDfi/UfCGswanpdyba8hzhhyCDwQR3Br03/hpjxZq+halbzpYGWGDelwsB3AmRF6EkHAY9vSqPwM+C9t8RNLvdc1GctZ2lytutmjbfMYBWYu2chcMBxySeoxzifEDwjZ+CPFf2eBli0283WrhpNyx5HDAk5IU7W57riuCp9UxFd05RvOPl+B3U/rVGiqkZWg/wCrnB32qz30zS3EzzSMSSztk5Jyf1Neo/Br4HzfEWxn13Ubk2Wg20hjbZ/rZ2C5ITsACVyT68d8eN3RktZ5YZlMcsbFGRuCpBwQa+wf2Q/GUGu+BLvw8LdkuNJZizAgiZZWdgcdcggjpjGOe1XmVWph8M50fL5IxwFOnWxHLV8/myLX/hlp1n4OtbY6HaSRwWvktLsXzGB53hsAhs859z618s+LNIHh/VXt4pGltyA0cjdSPf8AHNfcnjxzYaQYpN6q4KN+7J5/u+3418b/ABe1TdeQWiiN0UtL5ygfMT8u0Y5AG3GPXrXFlFWpVvza3PRzSlCEU1pY4ZpvemNKaqGX3qNpwO+a+rUD5ZyLTS++aY02KqNcenFRNP3zVqNiHMttMDxmoWn5qq0+e9RNNVWI5j6qlu1T+KtjwZe+G5NUb/hJpLyOyC5X7GBkt6HPOPpXBzakAvHNVX1Fj2xmvmZUueLjex9j7dJ3PfPFniH4ceIPDU9po1vdaVeadEZbeeUf63LcxnLktywPqBkjgGvGJL0LjLVhS37M33j7Yqs98O5pUMMqKcVJv11MamJ5nsbs2pKCRnca7L4XeL9A8JapcazrEb3V1ax5srVUyGkOfmJPAx29M57V5WLtppFRFZ3Y4CqOSfSop7iWKR0kBjdTtZWGCCOxrWpRVWLg+phHESjLmR6B41+Kus+N55zqEyG3ebzooVQYh4xtVjyBjqM8nnrXHPqOCSGpui+IINIF3LJYw39xJF5cBuAGjhORl9hGGOAQM8DOeaxmuDz09a0p0owXJGNkjKpWlL3m7s1X1DIwGJqtJdk5GRis1rknvkVG0+O9bqBg6hvaJaSa9rdhpiTxW73k6W6zXDbY0LMFBY84Azya7n4m/C26+F2l2U416yuLyQG11GytrtDNbyncdm0NuZCgByQOvPWvJodRktLiOeGQxyxOHRx1Vgcg07Vdbu9Z1C4vr24kuru4kMs00rZZ2JySTWUqVSVSLUrRW6tuCqxUWmtScSPK21FZzgnCjJwOTW14Q8KzeL9ZGmi8t9NnlhMlu164jSd8hUQE45Zjgdf0NYnhnxVd+E/EFlrFiV+1WcglQPkq3qCARkEZBHoad4v8a6h401VdQ1F4zcLBHbgQpsQKihRhRwOmcDAyTgCtJRqN8sdFbfz9P+CSpQSvLV9vL1Ok8deKrHVdO0jTUsEi1DSIzZveWs4NvOgdz8qbfVs7s85PHIxzeiaNfeJLp7fT4hPOqFym9VJHtkjNYDXHUZqTTtZuNH1G3vrRzHcQOHRsZwRTjRdOm40t/Pv/AMOP2sZ1VKtt1tvY6XxZ4WuvCtppsl2GWa6RmZSOFIx8ue5Gea5lrjg880mpa7e6rIz3Vw8u6R5QjMdqs5yxA6DJ9KoGStaUJqKVR3ZnXnTlUbpK0fMtNPg16P8As63WlR/FzRG1ZkWMFvs/mfdM5UiMH3yePfFeVNOMVJY6rcaZe295bSGG5gkWWKReqspyCPxFOtR9rSlTva6aIpVfZ1Iz7M/RbxPaW0Md87xK6SN/y0xwSOma+MfjSlrb6jCCW+25IIyCPL6j9SQPYV6vb/thWWoeDZTq3hh7m+jMUEnlXCiOUsrEtypKglCcc4yOa+bvGPjKfxhq015LBFaRs7NHBCOIwccZ79BXgZTg8RRnL2sbW8z3cxxlCtSSpu7Z3fwN+L138NNW1BFtE1DT7yEvPA77CDGrOGVsHnG4Y75HpXN/Ev4jP8QdcN6LJdOt1yI4BK0hGeuWPX8AK5jRJf8ASLk5wBaz5P8A2zaspp8CvoI4Wmq8qyXvaHhSxNT2KpX906DVpRqNlBqKndINtvcgjo4HyN/wJV/NW9RV/wCHPxM1b4YeJotZ0pkZ1UpLby5McyHqrAEfUHsQKxvC4/tC5vdPJJFzaTFQBnLxoZEx7kpt/wCBGsBpiOhrf2UJxlSmrr9GYOrKDjVi7P8AVH1zf/tdapqXhG2uF8PWUV5cm7Cu8zuiCKNSp24BJJYjGe3vx8t654kvvEF691f3L3MzFm3Oem5ixwOwyxP4109hYy2/wpvr68gkhmguR9g3cebFOuyZ8E5KL5cYDAY3SY9cedNN71yYLCUKDn7GNtbHRi8TWrKCqSvpcttOaiaYZ61WaY1G0nvXrWPKciy02O9RNNmoDL1qJp+ozVqJm5lgyZB5pnmgj/Gqxm9BimGTIrRQIcz6AaWUDgc9KjZZmHTH1r3Dw/8ADaG/t1LQxEe/Wt+H4S2o4MUP5V8JLM6EHY/RllFaS1Z83CznkOevrUg0O5YZC5H0r6VX4T2yj5Y4QP8Adq/bfDG2VNpEQ+i1k83pLZGkcll9qR4P4D8bXnw8WZ7fQtJ1G5dty3N/bmSSLjGFIIwP/r1X8X61cfFLxLY3LWNlpmpXWyG5mizHHLKWwHbJIAxjJ+uc19Bn4V2eCGERB/2RQnwnsOhSL8EFc/8AaWGU3VUfe7/0zV5TVcfZufunn/xX8ZeFPDukweD/AA7omk6y0Vj9nvNc+yRrK0u0BWjdV6gjJP0AIIJrlfgj8FD8S9RvG1JJ4dHgQq13DMI2WU/dCgqwf3HGAevQH25PhLp277sef90V1tro81locek2MkdjbAYc242s3qSfU965HmUaNF06DfM92/z/AOG0NP7Kc6inUaaXQ+Yfil8H9C8KWUtz4e16bV/KuTbTRMIyYWHZiCDng8hcHHWvMW8PXRGdjHvwK+01+Fen99mf90f4VNcfDDSRLiDJQDksBkn8q6KWdKnHlleT7sipkkKkrppelz4j/wCEdu2ziNz+FRt4avf+eTn/AICa+5E+GumKB8o/75FOPw30zj5Rj/drT+34/wApH9gQ/nPhU+HLzoIJf++a2PCfwq1zxpez2mmwA3MUXm7Jm8veNyrgE8Zyw6kdD3wD9uwfC7TZ4yyxggHstSL8O9NtzkJtYdMDBqJZ/p7sdRRyGlfWZ8JR/DnWrvWl0m0spLy9ef7PGsHzK75xw3THv0xzWz8W/g1e/DHxDbaZvlvvNsoblpFjICuwIZfwZT+BFfa1t4EsbWUTQb4ZEORJHkFT65HSta8gkvdHbTLhxc2rLtbz08xvrk9/esnxBUU4tR93qv1+RbyGk4tRnr+R+by+G71zxazk+yGnDwpfkH/Q7jj/AKZn/CvvaX4Z6ST8sePpTU+F2mf3G+ldP+sK/lEuHqfWp+B8EN4U1DOPsdxx/wBMzUbeFNRH/LlcH/tma++j8LNNJ+4cU0/CzSy3MZNH+sS/lD/V2l/z8/A+GdE8LXs32jT7i1mhhu1G2V4ztjkXlGPtyyk9gxPaqdx4A1a2uJIZrC4jkQ7WUoeDX3gfhRpknSNhVyH4VaXcGITxGQQAsjN6Dop9RnFR/rCk7pFvh+ilrM+HR8OdR07SHi+xzNe3yLvXaQIotwYA/wC0xVT7AD+9wtj8Iri4jBljlRu67K+40+GGmfOZYS8jElix5J9aI/hVpJYHyKxfEEuh1QyPCRd5O58o/Db4OS6b4/8ADt95dxttL+C4Y7eio4Zj9MA1z978EJdU1xLbTo2hkvLjZFHJwq7m4GfQZr7g0z4Zabb3DTRw4ZYpFBz03KVP86qaP8F7Gw1yy1G3g2SW0qygt0ODWCz2pzud9bW/M2nlWA5HFRX4nxv4m8HT6pd+PrzT7aaTSorSCytGdcZC3EG3A7ZWN2/E5615U/gjUhn/AEGUAcklelfpPrPwQ0dNEhsrOFhbRSNM8Z/jY/xH1I/z0rkLj4LaMykfZh+Yrro8QKmrW/pKxwPIqGJXMp2ev5n58z+GLyNsG2dT9Krt4bvDyLd8fSvv1fgZoRLZtU/HFRXHwY0ONCBbR+3IruXEkOxzvhVSf8RfcfAD6Bcj/li35UjeHLsKCLdsH2r7sn+D+gxglrWH8xSf8K60BIwPs8Jx2yOK0XEkekR/6oN/8vF9x8FNolznBhIpP7CuT0ir7ev/AIc+H9xY29vgfSslvh5oCS5FtbnH0rpjxBGS+FmL4PnfSovuLfhL4rwi0RRtDY5FdJ/wtVQR8oI+leU6XBaW0KqiKB7CtNbi1A5UV5FbCUHNtRZ9NQVd01zyVz0z/ha8YQYUVGvxbwegrzX7bb4wEGKUXduTygH0rn+p0v5WdXLPpJHpn/C2fMIVVXexwM16ppslpoOmR6jr+qWtozcqBKNgx1XPVj9K+W5LyAdhiopNYhkKh2D7RgZOcD0FZzwEZ25NEZVLpWcke/a/8U9Ak0u5vNMlZpIJRFgALuz0bYSCVPPI5HcVzEHxpK/wZ/CvHZfENmkoUtHuParEWvWqDJCcd60WXQitYtkQqK/Lzo9dT4yTXcpSC0lndV3FY1LEAd8AdKgl+NlxaMVktJY29HUg1m/DPxp4b8KW15r15Kk+rIDFaWKq2SDjLbhwM5x9AetYviT4lSeLp0k1IK5jZtgHRQT0x049evqTXN9WhzuPsnZdb/kdEeab0mrHr/w18U6j47a5uWgMOmw/IZmyCXPZeOcDrS6541hmbZ4bmk1i4SYxSwx4YrjqccEj/aAI968vj+Jt3e6PaeH4JIbK0YrDlD5YIPHztngHOSfzr2H4C+ELKGK51yC4W7Vme2jkRNqsFI3MM9QSOK4a1KNG9ScbLov82TUUqScpT1PT7O2+y28aEAOFG73OOao3gabUIohbusXRpioZTx7fz4raZAfrUMy4RsHBwcGvDvc4Yzs7nO67byWljd/ZY2kwjNH5BDMzY+7gkD0714DffGXWLGdoLiwlglU4KSKVIr6FLGBvvgEHHHAqnrGh6X4gj8vUbGKZsff2jcPx7V30akIfxIcx005uPU8AX43al1+ynH41Kfjjqm35bNh+Brp/G/wpu9Mt5LrQ41v4VGWtyP3oHt615FL4ujti0U1t5UyEqyuuGB9CK9OnCjWV6dO/zPWhCnNXVT8EdpL8c9VVflsiT9DVH/hfOr+aVNmRn2rmV8eWydYIz+FZd/41tNxkEcaYrohhYt2dH8RyhTjr7W3yR6LD8b9YdsCyP5Gt2x+KWtTeHtXv/spDQtBCqnOfnLEn/wAc/WvFLX4pWaHCmHd716T8M9U1L4l6N4h0/RkikvImtZBuO1cbmDZPTgNnHXANZVsJ7OPM6VkvMz9phraVL7djp7T4n6vrmiXM0Nq6alZjzJIscTQ5wWH+0pIyO457Gt/wTe+NPFTq4sfsVqetxdfKMew6mu38A/DWLwii3N3cfbdSaMozAYjUHqAP8a7NV+XCgKnQAcYrxKlWnqoRRx1cVCN40ldd2VNOsF02DEkpnmI+ZyOv4dqvwv5i5xg+lNEe1ScdO/alEgj77iP4j0rjPKlJyd3uShTzx1ryT42WmteHLD+2tGjM9qOLqIHmL0ce3r6cfh7BGfMUEZ96dNax3NvJDMiywyKVdGGQwPUEelVCShJNq6CjXdCakj4db4peI5N4UbTn1zWVqfxI8TtjBGfc4q/+0t4H1b4Na2t/YRPc+G75z5EvJ8h+piY/yPce4NeD3XxOupBwuG9zX3OFwMcRCNWnCLTPXqZjhYqznK/y/wAj0648deJbgHdheefnqjceKfEsgG2RQM8/Oa8wPxFvSSDjBNPi+IV2g+ch+/NeqsvcdoR+4895hQlp7Sf3noZ1vxFJgPMgx/tGsO81jxNDMX85GX/e4FcyfHtzKwwAoqpqHi2e6QjcQCOccV008I4vWK+45a2IozjeE5X9Tr4vE0tqoXdhR0FW7bxNNdsfm2oDzxXKS7rm6+VSEz1ParWBaIC3BHQV1OETxKdaqnvojsoNW3r97io59YEPzGXb7Vxx1lsEA4HrVDVNUKoo37y3NJUk2dk8clC/Y29c8XS8RRSkHuVNYJ1q4UkiZsnqc1jtIZX3Z4oMtdCppaI8OeInVk5SfoaI1OUybi5Jz1zVgaxLI6qJGP41iPKEXNTWQJO88HtTcVa4oylzKKOri1mUAKrnH1qaPxBMX/1jZ6DmubknMa7Mjdn1o8wq6/MB3rFwTPUjVnHZnqnwturTxB4/0ay1W+t7LTFm866lvHXyzEgLMp3cEtjGPev0Q8P6bYaVoVvHpdpFZWJQNFDFH5aqG5+72PNflv4C0pvFvxI8PaSoyt3fwQED0ZwD+ma/WCRBBAAI9yAY2jsK+I4gjyzgk+j0OylWdS9+5ROc1Xu4RNCyZClu5/OrDTwscK+1v7r/ACmoZDHJ8jHaT2PGa+QW53q5zwhZZSBmQrk7fx9+venLIkmR0fvjofw+tacunmMHbl8j7wPzZqncQFgMpkg5yBgjjkkf5+tbqVzVMrSxNGdyN07g9a84+J/wl0n4iWryALp2sYPl3cY4f0Djv/OvSCjIrtEcKed3YfUVXn2tLhgEOcfU46GtqdWdKSnB2aN4tPRn57+NdB1fwJrcum6zC0E6cow5SRezKe4rmptQadCD37Zr7p+MHwts/iV4bksbmNYdRgBezuu6t/dP+yehr4ug8MXJ8RDQHtm/tIzi1EBHzeZu2gfTNfoGAx1PFUm5aSjv/mcNajJPR6M0fgf8HNV+MXiprK2LW2lwEPeX2OI1/uj1Y9h+Nfoj4I8C6N8O9Ag0jQ7Nba2jHzP1eRu7MepJrN+FPw8sfhh4Ns9FsUUTBfMupwOZZSPmYn9B6ACuzQKFyWAA6mvjczzGWNqOMdILZd/NmNKiqK8xFjyc859M0ZCELjJ/QUryFj8o49Ac5oEXzAkfjjn/AD1rxUi3IYW3k5ODxjbzQqEuQQDxwferUNo8vzMdqnrx1pl7qdjosRM0qqw525y1DaRKbk+WKuyW0gkU5bhT2PWs/wAQeLdM8NRZu7geY33IU+Z3Pso5rlPEfju6ngk8iVNNtAPmuJWAIH1PA+vP0rzGXxrY/aJBpNjeeIr1uGliBWM/70zckf7vFEYynsj2sNlkqnvVtuy/V7I6PxzeSfFjRNQ8P6jY/YtLu4yir/rLhW6q+0cLg4PJr86PiJ4SvfAPirUdCvyhubOTYWjYFXHVWH1BBx2r7q8vxbrDBrm/g0OzHP2LTlyf+BN1J/EfSvn39rLQfDEV1Zahb36ReKGVVurTBLXMeMLKcDCkYxyeR9K+x4fxDo1/q7d1Ltd2fe/9dDPN8DBUVOCSt5/1dnzY1xUL3Lc89afPGEG5aqs4+tfpkYpnwTfLo2TJeMp61N9s3jrWcT6A0xZcNwOfStPZpkLEOGjPWbq7aCRhgH2FZd3fMz8sG/pUs8V3cM5A3Z6tVK4tvs67XB8zqcdhXjKx21HJ7LQjnu2IJPH0rOkuzK+O3anTyqz7A3yjqaihjALOSOeg9q6opJXZ5NXmnKyehYWbZEeaFfdjNUXm+Y4+6DU4k2Rgnk4puNjSm+bToieRvMdV7d60SYooVfJ68AVSsYjKAW65y30q3JE0zqAwEYJ25rKXY9OjTdnPqxnmI4LvncTn2qzAYpEdySNg4q1Yaemr3sNuLiOJn+VQ46Ht+dezj9kHx3dWqRRjTY0lYFm+0Hhf++a4a2KoYdpVZqN+56FPDzac4q6X5/eXv2H/AIZXXib4nweJrm0kGlaSryRzsMI85G1VB7kBifbAr9B7mVLckMxXPtkVyHw18I6f8OfClho2nQKlvbRBeOrN/Ex9STXRX14JYm/dkYGcg1+aZjjXja7qLRbL0/4JpToeztH7/Ux9YuonJ2tFIfZ9hrn59SktweJlj9Hj3r+a5/lT9cv/ALHH5hExU8HBBAPPHI9q8v8AFfxb0zwyskl3p9xIqHlo4kyR3IIZc/hXmww1as/cjc+gpTo0o+/LQ9OsvE5DYSRZMdUVt/6dR+lbEGsWV+AsjLG/uf618uXH7Vnglxi4t9Zjwcf6tXH5MzUsH7UvgOQhRrV3be13YOcfipwPyrr/ALNxy19lL7glWy+ptWin6n1Lc2TZ8xDvUDIx97/69Z0tolwA2AWxtPGCT/nP4+teMeGf2jfDlzIq2XifTZif+WT3PlE/8BlCfpXqWk/ELSdaEQnIgdvuSZ+VvcH+orCcKtF2qxa9U1+aD6tJrmoyU13i0/yZNIZItqTjfEWwhHGB9f6V51N8J4G+O2jeKURfs4gkMuBwZ1ACN+RP/fNetSRKV3ofOhPOV5/l/Os24ga0jV05jjYSKe4x1/TNXTrSp3cHa6a+TIjaXuyOsgDCPLfMfep0TLAcgdM1HENzAj7pAOa0be18wg4AXrn1rlR5dSdiCCBmB2gHHc0+4ltdLQz3EqxgDq3GaxfFXjq08PK1tb7ZrsDkZ+VPqf6V4zr/AI7v9auH+xW82sTg8vu8q3j/AOB/4fnVJOT0PQwmW1sUueWkfzPRvEPxLO5rfT1bPqg3P+Xb6nFeS+L/AImadoEjPrfiDT9Fc87Z5RNdH6RjofpurHvvC2u+JoZP7Y8RvZWR5a00cNGij3kXn65fFcnJpvwk8DyM11qumrcA/MHvIjIT7hN7fmK7qFClJ68032ir/i1+h9CqNLBxtFxj5vX/AC/Mpav8f/DTTE6X4f13xjdpyk93GY4c+q7xhfwSsK7+LvxS8SSRRafpVh4bsW4/dxedKg/4F8v5KK3J/j/8J9FbFqY7thx+5sppc/i+wVVl/a58NwqRpnh/UJT/AAlbWGEH8Szn9K96nhqsV+6wTfnO7/B8q/A8yri8NJ/vcXfyjZfkpP8AFEek+F/F+pXn2nUdW1TVHP8ABISIxz2QcD8K6L4hfA29+KHg0ItuLbxBYqXs5pSFEnrEx9G7ehx755iT9pzxDqAH2HwbfBT0aa4f+SIv866+TxTrni3wlcS6RbQaX4gMXmWwuYzJiQc7DvJ64Iz2yDUNY6hVhUfLF37qy9VHp3OpzwuKoTpUotq19pX+Tla7Ph7UY7nS725sb2Fre7tpGhlhkGGR1OCD7giqJcckCtXxp4k1bxV4mvdQ11lOrs+y4xAsJ3L8uCqgDIxg8Z9axBKAvHXvmv1anF8iclr1tsfk7cYydnor2vuSlwnUZBph2k8Ac+tKCrEHOV6/SlZIwQ2c9qvYvWS6Hrj297G8kMdvMWB3gnGAD61l+IY5tOijRnXzJVzjHzY9/au+1aE6Ha3N3dyRvCvKjbyx9Dz615ZK8mr3jXd2xbzHyFH8XoAPSvm6E/a+90R72Op/V0qWvM/wXcq/ZhKgYrx1GaRuMqB068Vox2xnsbu9BUx24HHTJJx+lR2trvhiQblctvc9fpXbzdzy1S2st/8AhiiLYs33cADJ4qKKB7y9WCPnHU9q273ba2RPnIzNl8A84HC/1NbPgbRGi3TuQTJyVZCSMDjJ/wA9KUqvJByZvTwnt60aEVvq/T/gi31strYLHFArlVxJgYyf5ms6S1a0QSzLklWPT7ortJIhcoYGlwR97b1BxVbULKJ7Sa3DFpI0IU5xngjHH0rijWSdmfWSwV05rotNtyt8LtBGuePPDtsYy7X2oQrjHGwMC5/LA/Gv03srUEqAOBXxF+zj4ZW7+MejSxqTBawySY64IVznP1K1966VabiDivhc/re1xEIrovzf/AM50/qcHF7lpbNVjUHqBUF7bKIcDOSQK1JAq5ycD3rOvNW061H+kXUCY7O4r5xpJnlwlOT0uzndS0iGfAYEAHcAPUDivJPHvw2sdShZHtZpywYnZnHTjFetat8S/DWmqRJqCEjtGhb+lef6/wDHXw/grbw3Fy3bKhM/mc100alWDvTue1hsNXqfFSbXmv8AM+b9e+BNrczp5Wi3IfHBLkAjcSSfQ9K5GX9nWS6V9ul342/8Bycdtwr6F1D43ksfs2k8HgFnJ/oK5fU/jJruT5UNpAv+0M4/WvfpZjjYq0fzPSeSUams6S/A8Wvv2UNQKbohNGxBOGIYDj6DPauVn+GXxE+G7mXRry8iQHLJA5VW+qH5T+NfQA+LHiWRsiW0cf3fLyKVvidrUvyz2VpMOhGxh/Wu6Ga41e7V5ZLs7GE+HMJfmpRcJd4yaZ5j4B/a68Z/Di8itfE+nNd2hYBm2lCR646flj6Gvs34Z/Fjw18WtJW90S6jkl2/vrRjh09eK+a9W1LRfEcBj1bQQqv1dAGH5f8A164X/hAbjwrqw174eatLbahAd/2QMfn/ANn/AOsa569DBY1XjH2U/LWL9e3qYywONofHL2se9rTX3aS/B+Z+jOgwGTT7dGb54sxMfXacZ/HH61zHxA+I0WnCTTNMnQXI+WWZT9z/AGR7/wAv5eBXX7T+vw/DVIZ9MfTfFF0/kysuDtG0ZZB2Y8fTk9q4TQfE15DMXv0nurgnJhhJLL9Txj6kg/yrwfqFZRbfe2+//AOrBZfCdV1cQ9tUu/r/AJHrGoXvnuY2im1C4PP2WFd5Pu3b/vo/garT+HvFmsAAXNn4ft8YA+WWVR7bhtX8EFZFp8S0t40iN3pOhxkZCTzCRz9Vyoz+dbFl4ms9TAb/AISu8bI6WMAx+iN/OsfZVaWvL+F/0t+Z9HKd/dVvz/BHOap+zvpGvHd4i8RajrLA7sTXE8oH0UHA+gFPt/gH8PdMxi2YHAHGmyN0/wCAV0sul6fdEk+IdZGR96WIAf8Aj0OKpnw/ApPleMpY/wDZkeEY/AbDW31rEtcrqtLtql+BzRw9G/NZX/wr/JmZ/wAK6+HNkw3NJb7fXTpUxj/gFSJ4Y+GikE67bwn0lZo/54rRTQddVPOsvFUVxGO7tOP1811/8dpHtvGcXyv9k1NB0Blhm/8AHSkR/wDHqPaze9Vv5/5o3VOH2Xb7l/7aEWm+AEAWPxVpQ9B9rjH9a0LDSvCMEqyQ+JtNYjn5buI5/WuX1V9Sx/p3guCTDDcw08gEd+Y2lrKuX8GTAfb/AAvFaN32sEx/398v+VWoXW8vlyscqdWa92d/uf5HkH7ZvwlsNEvrXxtoV3bz22oMIr+KGRSVmx8soAPRgOfcZ/ir5bErBzz+NfeHi/wz4W17wvNBYQP5PEbwsyum057rkDB6c18b/ETwDdeBdWMLBpbGZibebGcj+6fcfr1r9L4fzCNaisLVfvR2vpdf5r8vQ/KOJMoqYSX1ylrB/F5P/J9+/qc7HOd2Ae2KWUtHyD8vfFV4vlY9ferCv8q7jweOe9fWtWZ8dCbnGzep714h87xtrZtoo2i02Fj5ZXkS4PL/AE7CqF1o8cdpcTNsiy3lWySNjjJAIGCSe+K7m9t47KzaKKZollAggKrtK4Hasx/D1jf3dhHPcSLFbZd3difmJHOevGM18HTxCjFJaRX9fjsfp9bBSlKUp+9OW7vbfRL0Su/SxyEnhaW2itYPKdbbYGlwSNzbvlB/n+NaNnokiAu8RZW+RQzdF6HP0GefauvWBpfMAV5DKd2CT8q5woGe/Q1SuILbSrNlG5kJKHcxbjv1Pc/zq/rTl7vUuOXwp++vhX9f12ucinh4a3rrrEGktoCGdypC8AYGfzPFdpY6fDaQNAp5CHLEf/XzW3a+GrqPQf8ARlj86ZWcjjaD6kfl+Fc/ZeDtVZp0fy5vM3qpLkhM5H4dq5J4uFe6c0kv6uerh8FPCWqRpuUp6vy7Ixp7m3sbuFI54slSyE5YLjk7mz7fnWrp1uzm8d2V4zJtVlUYIyePfqaSz8F/2bYwpcCNLvYxMkJJweSeh966G7tBGGjWQAKcsR3w3Q1NbE09Iwd/M9DB4atrOsuXql6q1j3L9lDw5Ems6nqcjB7iGAW4AwDztySO33a918WeN/7HY2tq4V1HzyA8g+gr4IvvG3jbw0ot/A+sS6ZfSz/aLlolQ+YiqAobcCMbnP1z7V1lwnx81fT7Oe81zR3F04TLabblxkE5P7rnpXz+Ky51ZqtOtCPN0baf5M8ivJ1MbO9CU4xstLW/Fq9j6WvvHXmL88xc4yS7mvPvFHi430c0cU/klgV8yNhuX6ZrwG+8AfGK71K5tf8AhJFzCgdnjiSJee3EdcQ3gv4p3yXE0XiC9khjcpvivSoYjrjAq6GUUXr9Zh+P+SOz67UoaU8FUf8A4B/8kz3zVNXkvIRGbksR3ZlyaxJ7+aNRtdcjjuf5Cvmr7J4+1LU5rFb/AFq6kiYqzC+fYMdeelZs/h3xXdXLwSSahcMjMpL3TMuQecHPrX0FPIYJ2liI99v+CebLiisl7mBnvbVrdb9D6SuL2aPGZ3x1+439ayr/AF2KKMtNcfKozyVUfqRXzvd/D7XkwZbKZie5k3fyNYtx4YvoSQ9s6fUGvTpZJQevtk/RL/M8rEcUY+Gn1Nr1b/yPdn+KmixDInmYdMjYP60R/GXSYCT51wP+Bxf/ABVeA/2FNzkHj2qGbR3jBzkc16iyfBvRyZ89LiTOI6+yS+8+jIfjloajDzPg9WZUP8mrSn+Nfhaz0W61W2u2lvYiNsS5Vy3YDP8A9cV8wHRZcgBWqzD4cnliZ9jbV5PHSs5ZHgdHzP7zWHFGdyvFUo7dnp5/I908C/tMQ6xrczeM4oYkVCba5hjP7vjoR3PA5pdZ/ac0Ny8dlos1zFnj7Y+EPvsHFeC/2DJITtXcajOkSIWXbgiur+yMvc+dK3knZL+vU8n+389p0VSbT31aTb/TT0PXl/aWu7VSllY2Vmmc4SMj+Qqzp/7VXiDT5i6ywMPRjMP5NXiLaY6sQVNNOmuD9wn8K6HlOXyVnBM4f7fzxO/tH9y/yPqDR/23Nct9qzNYqvfP2k/+zGuq0/8AbjTcBdmzlU9ciVQP/IbV8cLpMrrlUJoGlS55jP5VwVOHcqn9i3odtLiXOafxRUvVf5WPtdf20PC8kgNzpelz+rbpSf1txWrbfti/Dl1P2i0aEHgraNKP/ZFr4YGhTHP7ojjIyOtRRaY0hI2kHOK5Hwvlklo3953rivOItJ0o6/4v8z9A7D9r74XhSp1XVYR2EiF8ficmtqD9rX4V3C4bxE4B7T2r/wCFfnR/Y5UHIwQasL4fBTdurllwplvSpL71/kdEeJs3m/4MPx/zP0Nvv2hvg3rGn3EE+u2URlQqZFt2Dg9iCFzXkureOvhd400q90q51G41Y4IU2dlKZF/uuCVxXyY2hLGhcvwOais5PsU25eB0zWlHhnC0veo1Z3W2qX6Gj4px8H7LE0oqEt93p82a2q6dHp99PDDI8iK52NNHskK9ty9jVSJsEqTkehHerO3zvnUAk9RVeWMqxJGK+qi9LN6nzlVcr54LT9D661yMXFxdtKEhEJKxogwABz+PNYOl6PJcTQB3UNJ+9kDdAK1dfZs3Jyc+f1z/ALVWLPi/cDgeR/SvzGNWcKTae/8AwP8AO5+1ewhUrpPp/wAH/KwiouxjG6q4IIB9+Kit/Cq65Ik2xjDbtkOvTcP/AK9Oc4V8ccmus8DgHwnMSMks/NczlKEHOL10X3nZUjGU1Skrp/pZjQXsYoIntwqCEhyx+/xwc/SsCZ4/Mlk8wriMt8p2kHt9a63XFG+2GBjZjGP9kVxF2ALi4AGBtPA+lcFLVv8ArqestI3K0dzESiRs2WTaWJyfrT9VujvnAGHL7SwPUVmR8XEOOM1NdEknJJ+evWdFRmv66nDHEOUZK1rf5E/gjSjd+KvLLbmvblFI3dIkUZ/DcT+VfTenyrH4hZROWtrG2y8fZWPc/hXzj8FAH8TbmG4iEkE9vmavUtEnkNj45cyMWG0BsnOMGvKzROVflfRL8ThwC9phlP8Amb/FnQ297e6tpt5dM4ii1G48m3cfeMecFvyFcx8TtQtPBWlW9laSxx3FydkaqMHHX8811+ngf2R4SGBjyFOPfZ1ryb4xqJPiXpSsAyhRgHkDg1x4SlGpW5ZbK7+46q1adON6el3b8VE2dD8KwXWkwwJcxo7rmY4+bcetc9H4NS2aQOUZTIVUpjJOTk10dmTFBclDsIXqvHpWIjt5cZ3HO9u/vVRqTSk092ezFOU1za2Rla54YVdzMI1Gflxxu61y2peArW4MImiCkp8uwkDrXayOzOwLEgN0JrNvpGzjccALgZruoYmtTsoyM62Go1rupFM45/hZYyxhY8gnIDk8rWB4r+FcWmaPO8cglmiG7dj7+O1er2/+rgPesbxWxazOST+6br9K9LDZjinWjBz0ueNjsqwf1ac400nyux5ufh38ifcDMoY4HQ45/wA+1Pg8GNbWlyrxhg5+VV712ETE2MJycmNec+1WYz/qv96vW+u1tm+pwPLsMkpRjrb9F/meaWfgdoA7NEqknlTycDritEeDrC5USC3aNnX5gDXXzcyNnn5TTEUC2XAHSt5Yyo1c5qOW0H7ttPNHnmo+CbK1aGRiRGrkSLj+H1qx/wAIdZh2MEQki4PDc+4rrtRUf2fecD7lZd4NliCvynA5HFddPEVKi3OKphKFGpJcita/5r9DOu9G0G2tiSpgyMDavIPrWatnoEIR2kQysc/cIXHoR2rZ1v5tIcnk4HWuHvwPsY4/ireknLRyZ52MrRoT92nHa+x081tYXM0ypKpgCbV2tgqfbIrhbvTvsF8QBuRucnnmt6x6w/SqWuMTG5ychuK6qTcXy33PFxc1Xpqo1ZrUzViVhuKdM/L3zSFh5DfKNwOQR6VHK7CRyCQSvrVdmORyetdajc4XVWyRDeSZQDgZrNJQSbSuTV3UPufjVK66Ie+OtdtNaHzWNk3JvtY09OKbdhzyeDWkLKOSGRiOg+6Tyax7Y4QY45FbdvyB/ntXNVundHo4Kq5w5ZLY/9k=");
   imageElement.appendTo('#divTextArea');

 });  

// end of adding funcationality to append images to write zone 

 $("#dropDown").change(function(){
            // alert("hello drop down"+this.value); 
            // alert("1");
            var selectedDropDownValue = this.value;
            var ddlBooks = "#dropDownBooks";
            var listOfBooks = "";
            var firstVariableForDropdown = "Please select book";
            // alert("drop down category is : "+selectedDropDownValue);
                    $("#waitSymbol").show();
                    jQuery.ajax({
                                url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+username[1]+"/"+selectedDropDownValue,
                                dataType: 'text',
                                success: function(data){
                                    // alert("came in the call back function"+data);
                                    // alert(" result :  "+data);
                                                            listOfBooks = data;
                                                            // alert("list of categories is : "+listOfCategories);
                                                            var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                            // alert("parsed list of books is  : "+parsedListOfBooks);
                                                            var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                    return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                });
                                                            // alert("parsed list of books is  : "+parsedListOfBooks);
                                                            $(ddlBooks).empty();
                                                            $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                            for(var i=1;i<parsedListOfBooks.length;i++){
                                                                     $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                     $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( create-mode )">' + parsedListOfBooks[i] + "- ( create-mode )</option>'");
                                                            }
                                                            $("#waitSymbol").hide();
                            }   
                                }); 



                                                                                              // resetCode
                                                                                             $("#divTextArea").text("");
                                                                                             $("#newTopicInputId").val("");
                                                                                             $("#newBookId").val("");
                                                                                             $("#topicDropDown").val("1");
                                                                                             

      });         

 

         $("#dropDownBooks").change(function(){
             
            var bookName = this.value;
          
            // alert("book name is : "+bookName);
            var userName = username[1];
            // alert("username is : "+userName);
            var categoryName = $("#dropDown").val();
            // alert("category is : "+categoryName);

            var bookSplitName = bookName.split("-");
            var bookTrimmedName = bookSplitName[0].trim();
            // alert("book trimmed name is :"+bookTrimmedName+":");


            // $("#bookLayout").show(); 
                    if(bookName.indexOf("create-mode") > 0 ){
                            // alert("matched");
                    
                    // intitalizing wait
                    $("#waitSymbol").show();
                    jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);

                              history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                // history.pushState(data, "book-title", "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputId").val(topicName);
                         $("#divTextArea").text(pageContentWithoutPreValue);
                         $("#topicDropDown").val("1");
                         $("#newBookId").val(bookTrimmedName);

                         // closing wait symbol
                        $("#waitSymbol").hide();

                    }   
                        });

                        }

                        else{
                                $("#waitSymbol").show();
                                jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                             $("#bookLayout").show(); 
                             $("#bookTitleWhileRead").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                  // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = data.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                 $("#divTextAreaForRead").text(pageContentWithoutPreValue);
                                 $("#topicDropDownWhileRead").val("1");
                                 $("#topicFetchedWhileRead").text("");
                                 $("#waitSymbol").hide();
                                
                    }   
                        });

                        }
           

      });         

            $("#topicDropDown").change(function(){
            // alert(" Value of selected book title : "+this.value); 
            var topicNumber = this.value;
            // alert("book name is : "+bookName);
            var userName = username[1];
            // alert("username is : "+userName);
            var categoryName = $("#dropDown").val();
            // alert("category is : "+categoryName);

            var bookName = $("#newBookId").val();
            var bookId = bookName+":"+topicNumber;

                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                    $("#waitSymbol").show();
                    jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            if(data.length>0){
                              // alert("topic exists");
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputId").val(topicName);
                     // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                         $("#divTextArea").text(pageContentWithoutPreValue);
                         $("#waitSymbol").hide();
                         // $("#topicDropDown").val("1");
                         // $("#newBookId").val(bookTrimmedName);
                       }
                         else{
                            // alert("topic doesn't exist");
                             $("#divTextArea").text(" No contents for this topic ! . It's empty .");
                             $("#waitSymbol").hide();
                             $("#newTopicInputId").val("");
                           }

                    }   
                        });


      });       


            // to eliminate hiphen from book name
            $("#newBookId").keypress(function() {
             var keyInput = $(this).val();
             // alert("keyinput"+ keyInput);
              if(keyInput.indexOf("-") > 0 ){
                alert("We request you not to have hiphen character in book name");
                 $("#newBookId").val("");
              }
            });
            // end of code to eliminate hiphen from book name

             // to have character count in category
            $("#newCategoryInputId").keypress(function() {
                 // $("#newCategoryInputId").val("");
             var keyInput = $("#newCategoryInputId").val();
             // alert("keyinput"+ keyInput);
              if(keyInput.length > 12 ){
                alert("We request you to have category less than 12 characters");
                 $("#newCategoryInputId").val("");
              }
            });
            // end of character count in category


              // search suggestion for thinkers 

              // end of search suggestion for thinkers

              // search thinkers functionality
            $("#searchThinkers").keypress(function(e) {
                 // $("#newCategoryInputId").val("");
                  e.stopImmediatePropagation();
                  if(e.which == 13) {
                   
                    // e.stop();
                    // e.preventDefault();
                    // var userName ;
                   var userName= $("#searchThinkers").val();
                  
                  /* var newUrl =  "http://localhost:8080/portal/library/"+keyInput;

                     var userMatch = "false";
                   for(var i=0;i<availableTags.length;i++){
                   
                    if((availableTags[i]==keyInput)){
                      
                       var objectEl = document.getElementById('contentOfThinkersTab');
                        
                       objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"');
                       userMatch = "true";
                      break;
                    }                
                   }

                   if(userMatch=="false"){
                    alert(" User not found ! ");
                    
                   }*/


               /* var currentUrlParsed = currentUrl.split("library"); 
                var userCategoryBookParsed = currentUrlParsed[1].split("/");
                var userName = userCategoryBookParsed[1];
                var categoryName = userCategoryBookParsed[2];
                var bookTrimmedName = userCategoryBookParsed[3];
*/
                  // alert(userName);

                   $("#divTextAreaThinkers").text("");
                   $("#newTopicInputIdThinkers").val("");
                   $("#newBookIdThinkers").val("");
                   $("#topicDropDownThinkers").val("1");

                 $("#welcomeTextThinkers").text("Thinker :  "+userName);  


                 // disabling some of the buttons for the logged out user
                 // $("#logoutPlaceHolder").hide();
                  // disabling the logout button , enabling of login button should come here itself by writing one more  span in html
                 // by keeing that hidden and showing for logged user entrance .
                 // alert("here");
                  $("#newBookButtonIdThinkers").hide(); // disabling create / update book button for logged out user  , working presently on this .
                  $("#newCategoryInputButtonIdThinkers").hide();
                  $("#newCategoryInputIdThinkers").hide();
                  // $("textarea").prop("readonly","true");
                  $("#newBookIdThinkers").prop("readonly","true");

                  $("#waitSymbolThinkers").hide();

                  // zones hiding 
                  // $("#zones").hide();


                  
                
                  // hide register/login place holder
                   $("#registerPlaceHolderThinkers").hide();
                    var firstVariableForDropdownThinkers = "Please select";
                     $("#dropDownThinkers").empty();
                      $("#dropDownThinkers").append('<option value="' + firstVariableForDropdownThinkers + '">' + firstVariableForDropdownThinkers + "</option>'");

                  // resetting the page for new book
                   // resetCode
                                                                                       


                  

                   // alert($("#dropDown").val());
                   // alert("category name is : "+categoryName);
                   // $("#dropDown :selected").text(categoryName).attr("selected", "selected"); // setting the category on landing of logged out user.
                   // end of disabling of buttons for the logged out user 

                // $("#waitSymbol").show();

                // getting book details for guest
                /*jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            // alert("categoryname is : "+categoryName);
                            if(categoryName==null){
                              // alert("matched here"); 
                             }
                             else{
                               history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                             }
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputId").val(topicName);
                         $("#divTextArea").text(pageContentWithoutPreValue);
                         $("#topicDropDown").val("1");
                         $("#newBookId").val(bookTrimmedName);

                         // hiding the wait button
                        // $("#waitSymbol").hide();

                    }   
                        });*/

                    // displaying the list of categories for the logged out user
                    var listOfCategories = "";
                    var ddl = "#dropDownThinkers";
                    var ddlBooks = "#dropDownBooksThinkers";
                                    jQuery.ajax({
                                                    url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+userName,
                                                    dataType: 'text',
                                                    success: function(data){
                                                        // alert("came in the call back function"+data);
                                                        // alert(" result :  "+data);
                                                        listOfCategories = data;
                                                           // alert("1");
                                                           // alert("data is : "+data);
                                                        // alert("list of categories is : "+listOfCategories);
                                                        var parsedListOfCategories = listOfCategories.split(",");
                                                        for(var i=0;i<parsedListOfCategories.length;i++){
                                                                  // alert(":"+parsedListOfCategories[i]+":");
                                                                 $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                 // alert($(ddl).val());
                                                        }
                                                }   
                                                    }); 

                 

                    // displyaing of the profile pic for the logged out user 
                    $("#waitSymbolThinkers").show();
                    jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getUserData/"+userName,
                            dataType: 'text',
                            success: function(data){
                             getElement("profilePicThinkers").src = "";
                             getElement("profilePicThinkers").src  = data;
                             // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                             testString = "Book1IntitialBook";
                             $("#waitSymbolThinkers").hide();
                    }   
                    });

                    // get element by id method
                      function getElement(id) { return document.getElementById(id); } 

                    // displaying categories for the logged out user , displaying books based on category
                         $("#dropDownThinkers").change(function(){
                        var selectedDropDownValue = this.value;
                        var ddlBooks = "#dropDownBooksThinkers";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                             // $(ddlBooks).empty();
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+selectedDropDownValue,
                                            dataType: 'text',
                                            async:false,
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        $(ddlBooks).empty();
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                      
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   

                                            }); 
                                 // code for general reset
                                                                                             $("#divTextAreaThinkers").text("");
                                                                                             $("#newTopicInputIdThinkers").val("");
                                                                                             $("#newBookIdThinkers").val("");
                                                                                             $("#topicDropDownThinkers").val("1");

                  });         

                   
                    // end of displaying categories for the logged out user


                    // to show book for reading on clicking on the books in the drop down list
                    $("#dropDownBooksThinkers").change(function(){
                         
                        var bookName = this.value;
                      
                        // alert("book name is : "+bookName);
                        // var userName = username[1];
                        // alert("username is : "+userName);
                        var categoryName = $("#dropDownThinkers").val();
                        // alert("category is : "+categoryName);

                        var bookSplitName = bookName.split("-");
                        var bookTrimmedName = bookSplitName[0].trim();
                        // alert("book trimmed name is :"+bookTrimmedName+":");


                        // $("#bookLayout").show(); 
                                if(bookName.indexOf("quick-view") > 0 ){
                                        // alert("matched");
                                
                                // intitalizing wait
                                // $("#waitSymbol").show();
                                // alert("category name is : "+categoryName);

                                if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownThinkers").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                }

                                $("#waitSymbolThinkers").show();
                                jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                        // alert("data received is : "+data);

                                         // history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                         var splittedData = data.split("&&**");
                                         var receivedTopicFromDatabaseArray = splittedData[1];
                                         var pageContent = splittedData[0];
                                         // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = pageContent.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         // end of parsing of page contents to remove pre tags
                                         var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                         var topicName = topicNameArray[1];
                                 $("#newTopicInputIdThinkers").val(topicName);
                                     $("#divTextAreaThinkers").text(pageContentWithoutPreValue);
                                     $("#topicDropDownThinkers").val("1");
                                     $("#newBookIdThinkers").val(bookTrimmedName);

                                     // closing wait symbol
                                    $("#waitSymbolThinkers").hide();

                                }   
                                    });

                                    }

                                    else{

                                        // alert("category name is :"+categoryName);
                                         if(categoryName=="Please select"){
                                          // alert("matched");
                                        categoryName = $("#dropDownThinkers").text();

                                         var categoryParsed = categoryName.split("\n");
                                           // alert("topic number is :"+categoryParsed[1]+":");
                                          categoryName = categoryParsed[1].trim();
                                          // alert("category name is ="+categoryName+"=");
                                        }
                                            $("#waitSymbolThinkers").show();
                                            jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userName+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                         $("#bookLayoutThinkers").show(); 
                                         $("#bookTitleWhileReadThinkers").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                              // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = data.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                             $("#divTextAreaForReadThinkers").text(pageContentWithoutPreValue);
                                             $("#topicDropDownWhileReadThinkers").val("1");
                                             $("#topicFetchedWhileReadThinkers").text("");
                                             $("#waitSymbolThinkers").hide();
                                              $("#newBookIdThinkers").val(bookTrimmedName);
                                            
                                }   
                                    });

                                    }
                       

                  });      // end to show book for reading on clicking on the books in the drop down list    

                  
                  // after the book gets rendered as above , the topic wise content of the books to be fetched in write mode for logged out user first

                 $("#topicDropDownThinkers").change(function(){

                  // alert("please confirm selection of category to read other topics of this book");
                var topicNumber = this.value;
                // alert("topic number is : "+topicNumber);
                var categoryName = $("#dropDownThinkers").val();
               /* // alert($("#dropDown").val());

                var categoryParsed = categoryName.split("\n");
                 // alert("topic number is :"+categoryParsed[1]+":");
                 categoryName = categoryParsed[1].trim();
                 // alert(categoryName);

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = $("#dropDownThinkers").val();

                 }*/

                var bookName = $("#newBookIdThinkers").val();
                 // alert("topic number is : "+bookName);
                var bookId = bookName+":"+topicNumber;
                 // alert("topic number is : "+bookId);


                /* if(($("#dropDownThinkers").val()!="Please select")&&($("#dropDownThinkers").text()!="Please select")){
                  // alert("matched here 1");
                  categoryName = $("#dropDownThinkers").val();
                 }*/
                 // alert("hello");
                 // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                
                        
                        $("#waitSymbolThinkers").show();
                        jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                            dataType: 'text',
                            success: function(data){
                               
                                if(data.length>0)
                                {
                                 var splittedData = data.split("&&**");
                                 var receivedTopicFromDatabaseArray = splittedData[1];
                                 var pageContent = splittedData[0];
                                 var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                 var topicName = topicNameArray[1];
                         $("#newTopicInputIdThinkers").val(topicName);
                         // parsing page content to remove pre tags
                                    var pageContetnsWithPreTage = pageContent.split("pre>");
                                    var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                    var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                    var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             $("#divTextAreaThinkers").text(pageContentWithoutPreValue);
                            
                             $("#waitSymbolThinkers").hide();
                           }
                           else{
                            // alert("topic doesn't exist");
                             $("#divTextAreaThinkers").text(" No contents for this topic ! . It's empty .");
                              $("#newTopicInputIdThinkers").val("");
                              $("#waitSymbolThinkers").hide();
                           }

                        }   // end of success call back
                            });

                  });   

                  // end of toic wise reading of book in write mode

                     // $('#dropDownThinkers :selected').text(categoryName);
                     // $('#dropDown :selected').value(categoryName);

                     // alert(userName+categoryName);

                     // displaying books in book drop down when the category gets pre selected for certain logged out user
                        var ddlBooks = "#dropDownBooksThinkers";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                       

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+categoryName,
                                            dataType: 'text',
                                            success: function(data){
                                               
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   
                                            }); 
                     // end of displaying of books for pre selected categories


                     // start of topic wise contents display while read mode for logged out user

                            $("#topicDropDownWhileReadThinkers").change(function(){
                            // alert(" Value of selected book title : "+this.value); 
                            var topicNumber = this.value;

                            
                            /*var bookNameAndCategoryName = $("#bookTitleWhileReadThinkers").text();
                            var bookName = bookNameAndCategoryName.split("(");
                            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
                            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
                            
                              if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownThinkers").text();

                                 var categoryParsed = categoryName.split("\n");
                                   
                                  categoryName = categoryParsed[1].trim();
                                 
                                }*/

                                  var categoryName = $("#dropDownThinkers").val();
                                  // var bookName = $("#dropDownBooksThinkers").val();
                                  var bookName =  $("#newBookIdThinkers").val();
                            

                            var bookId = bookName+":"+topicNumber;

                              // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                                    $("#waitSymbolThinkers").show();
                                    jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                                        dataType: 'text',
                                        success: function(data){
                                            
                                            if(data.length>0){
                                             var splittedData = data.split("&&**");
                                             var receivedTopicFromDatabaseArray = splittedData[1];
                                             var pageContent = splittedData[0];
                                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                             var topicName = topicNameArray[1];
                                     $("#topicFetchedWhileReadThinkers").text("");
                                     $("#topicFetchedWhileReadThinkers").text(" Topic Name : "+topicName);
                                     // parsing page content to remove pre tags
                                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         $("#divTextAreaForReadThinkers").text(pageContentWithoutPreValue);
                                         // $("#topicDropDown").val("1");
                                         // $("#newBookId").val(bookTrimmedName);
                                         $("#waitSymbolThinkers").hide();
                                       }
                                         else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForReadThinkers").text(" No contents for this topic ! . It's empty .");
                                             $("#waitSymbolThinkers").hide();
                                             $("#topicFetchedWhileReadThinkers").text("");
                                             $("#topicFetchedWhileReadThinkers").text(" Topic Name : ");
                                           }

                                    }   
                                        });


                      });        

                     // end of topic wise contetns display while read mode for logged out user 


                     // start of method for closing of read view for logged out user

                    $("#closeButtonThinkers").click(function(){
                            $("#bookLayoutThinkers").hide();
                    });


                     // end of method for closing of read vierw for logged out user
                      // return false;
                      // e.die();
                } // end of search hit button case 
             
            });
            // end of search thinkers funcionality


              // search books functionality
            $("#searchBooks").keypress(function(e) {
                 // $("#newCategoryInputId").val("");
                   e.stopImmediatePropagation();
                   if(e.which == 13) {
                   var bookNameEntered = $("#searchBooks").val();
                   

                   
                    jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getUserNameAndCategoryFromDistinctBookName/"+bookNameEntered,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                           
                            // data = data.substring(1,data.length);
                             // alert(" userList :  "+data);
                               var bookNameEntered = $("#searchBooks").val();
                           var userNameAndCategorySplittedArray = data.split(",");
                           var userNameFetched = userNameAndCategorySplittedArray[0];
                           var categoryFetched = userNameAndCategorySplittedArray[1];


                                
                  /* var newUrl =  "http://localhost:8080/portal/library/"+keyInput;

                     var userMatch = "false";
                   for(var i=0;i<availableTags.length;i++){
                   
                    if((availableTags[i]==keyInput)){
                      
                       var objectEl = document.getElementById('contentOfBooksTab');
                        
                       objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"');
                       userMatch = "true";
                      break;
                    }                
                   }

                   if(userMatch=="false"){
                    alert(" User not found ! ");
                    
                   }*/


               /* var currentUrlParsed = currentUrl.split("library"); 
                var userCategoryBookParsed = currentUrlParsed[1].split("/");
                var userName = userCategoryBookParsed[1];
                var categoryName = userCategoryBookParsed[2];
                var bookTrimmedName = userCategoryBookParsed[3];
*/
                  // alert(userName);

                   $("#divTextAreaBooks").text("");
                   $("#newTopicInputIdBooks").val("");
                   $("#newBookIdBooks").val("");
                   $("#topicDropDownBooks").val("1");

                 $("#welcomeTextBooks").text("Thinker :  "+userNameFetched);  


                 // disabling some of the buttons for the logged out user
                 //
                  // disabling the logout button , enabling of login button should come here itself by writing one more  span in html
                 // by keeing that hidden and showing for logged user entrance .
                 // alert("here");
                  $("#newBookButtonIdBooks").hide(); // disabling create / update book button for logged out user  , working presently on this .
                  $("#newCategoryInputButtonIdBooks").hide();
                  $("#newCategoryInputIdBooks").hide();
                  // $("textarea").prop("readonly","true");
                  $("#newBookIdBooks").prop("readonly","true");

                  $("#waitSymbolBooks").hide();

                  // zones hiding 
                  // $("#zones").hide();


                  
                
                  // hide register/login place holder
                   $("#registerPlaceHolderBooks").hide();
                    // $("#logoutPlaceHolder").hide();
                    var firstVariableForDropdownBooks = "Please select";
                     $("#dropDownCategoryBooks").empty();
                      $("#dropDownCategoryBooks").append('<option value="' + firstVariableForDropdownBooks + '">' + firstVariableForDropdownBooks + "</option>'");

                  // resetting the page for new book
                   // resetCode
                                                                                       


                  

                   // alert($("#dropDown").val());
                   // alert("category name is : "+categoryName);
                   // $("#dropDown :selected").text(categoryName).attr("selected", "selected"); // setting the category on landing of logged out user.
                   // end of disabling of buttons for the logged out user 

                // $("#waitSymbol").show();

                // getting book details for guest
                jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryFetched+"/"+bookNameEntered,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            // alert("categoryname is : "+categoryName);
                            if(categoryFetched==null){
                              // alert("matched here"); 
                             }
                             else{
                               /*history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);*/
                             }
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             // end of parsing of page contents to remove pre tags
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#newTopicInputIdBooks").val(topicName);
                         $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                         $("#topicDropDownBooks").val("1");
                         $("#newBookIdBooks").val(bookNameEntered);

                         // hiding the wait button
                        // $("#waitSymbol").hide();

                    }   
                        });

                    // displaying the list of categories for the logged out user
                    var listOfCategories = "";
                    var ddl = "#dropDownCategoryBooks";
                    var ddlBooks = "#dropDownBooksBooks";
                                    jQuery.ajax({
                                                    url: "http://localhost:8080/portal/portal/login/getCategoriesListForUser/"+userNameFetched,
                                                    dataType: 'text',
                                                    success: function(data){
                                                        // alert("came in the call back function"+data);
                                                        // alert(" result :  "+data);
                                                        listOfCategories = data;
                                                           // alert("1");
                                                           // alert("data is : "+data);
                                                        // alert("list of categories is : "+listOfCategories);
                                                        var parsedListOfCategories = listOfCategories.split(",");
                                                        for(var i=0;i<parsedListOfCategories.length;i++){
                                                                  // alert(":"+parsedListOfCategories[i]+":");
                                                                 $(ddl).append('<option value="' + parsedListOfCategories[i] + '">' + parsedListOfCategories[i] + "</option>'");
                                                                 // alert($(ddl).val());
                                                        }
                                                }   
                                                    }); 

                 

                    // displyaing of the profile pic for the logged out user 
                    $("#waitSymbolBooks").show();
                    jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getUserData/"+userNameFetched,
                            dataType: 'text',
                            success: function(data){
                             getElement("profilePicBooks").src = "";
                             // console.log(data);
                             getElement("profilePicBooks").src  = data;
                             // an ajax db call to be made to fetch the list of books as per the user id and the category clicked 
                             testString = "Book1IntitialBook";
                             $("#waitSymbolBooks").hide();
                    }   
                    });

                    // get element by id method
                      function getElement(id) { return document.getElementById(id); } 

                    // displaying categories for the logged out user , displaying books based on category
                         $("#dropDownCategoryBooks").change(function(){
                        var selectedDropDownValue = this.value;
                        var ddlBooks = "#dropDownBooksBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                        // alert("drop down category is : "+selectedDropDownValue);

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userNameFetched+"/"+selectedDropDownValue,
                                            dataType: 'text',
                                             async:false,
                                            success: function(data){
                                                // alert("came in the call back function"+data);
                                                // alert(" result :  "+data);
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   

                                            }); 
                                 // code for general reset
                                                                                             $("#divTextAreaBooks").text("");
                                                                                             $("#newTopicInputIdBooks").val("");
                                                                                             $("#newBookIdBooks").val("");
                                                                                             $("#topicDropDownBooks").val("1");

                  });         

                   
                    // end of displaying categories for the logged out user


                    // to show book for reading on clicking on the books in the drop down list
                    $("#dropDownBooksBooks").change(function(){
                         
                        var bookName = this.value;
                      
                        // alert("book name is : "+bookName);
                        // var userName = username[1];
                        // alert("username is : "+userName);
                        var categoryName = $("#dropDownCategoryBooks").val();
                        // alert("category is : "+categoryName);

                        var bookSplitName = bookName.split("-");
                        var bookTrimmedName = bookSplitName[0].trim();
                        // alert("book trimmed name is :"+bookTrimmedName+":");


                        // $("#bookLayout").show(); 
                                if(bookName.indexOf("quick-view") > 0 ){
                                        // alert("matched");
                                
                                // intitalizing wait
                                // $("#waitSymbol").show();
                                // alert("category name is : "+categoryName);

                                if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownCategoryBooks").text();

                                 var categoryParsed = categoryName.split("\n");
                                   // alert("topic number is :"+categoryParsed[1]+":");
                                  categoryName = categoryParsed[1].trim();
                                }

                                $("#waitSymbolBooks").show();
                                jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                        // alert("data received is : "+data);

                                         // history.pushState(data, "book-title", "http://localhost:8080/portal/library/"+userName+"/"+categoryName+"/"+bookTrimmedName);
                                         var splittedData = data.split("&&**");
                                         var receivedTopicFromDatabaseArray = splittedData[1];
                                         var pageContent = splittedData[0];
                                         // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = pageContent.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         // end of parsing of page contents to remove pre tags
                                         var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                         var topicName = topicNameArray[1];
                                 $("#newTopicInputIdBooks").val(topicName);
                                     $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                                     $("#topicDropDownBooks").val("1");
                                     $("#newBookIdBooks").val(bookTrimmedName);

                                     // closing wait symbol
                                    $("#waitSymbolBooks").hide();

                                }   
                                    });

                                    }

                                    else{

                                        // alert("category name is :"+categoryName);
                                         if(categoryName=="Please select"){
                                          // alert("matched");
                                        categoryName = $("#dropDownCategoryBooks").text();

                                         var categoryParsed = categoryName.split("\n");
                                           // alert("topic number is :"+categoryParsed[1]+":");
                                          categoryName = categoryParsed[1].trim();
                                          // alert("category name is ="+categoryName+"=");
                                        }
                                            $("#waitSymbolBooks").show();
                                            jQuery.ajax({
                                    url: "http://localhost:8080/portal/portal/login/getBookDetails/"+userNameFetched+"/"+categoryName+"/"+bookTrimmedName,
                                    dataType: 'text',
                                    success: function(data){
                                        // alert("came in the call back function"+data);
                                        // alert(" book details are :  "+data);
                                        // resetting the editor after the save action 
                                         $("#bookLayoutBooks").show(); 
                                         $("#bookTitleWhileReadBooks").text("Book Name : "+bookTrimmedName + " ( Category : "+categoryName+" )");

                                              // parsing page content to remove pre tags
                                            var pageContetnsWithPreTage = data.split("pre>");
                                            var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                            var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                            var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                             $("#divTextAreaForReadBooks").text(pageContentWithoutPreValue);
                                             $("#topicDropDownWhileReadBooks").val("1");
                                             $("#topicFetchedWhileReadBooks").text("");
                                               $("#newBookIdBooks").val(bookTrimmedName);
                                             $("#waitSymbolBooks").hide();
                                            
                                }   
                                    });

                                    }
                       

                  });      // end to show book for reading on clicking on the books in the drop down list    

                  
                  // after the book gets rendered as above , the topic wise content of the books to be fetched in write mode for logged out user first

                 $("#topicDropDownBooks").change(function(){

                  // alert("please confirm selection of category to read other topics of this book");
                var topicNumber = this.value;
                // alert("topic number is : "+topicNumber);
                var categoryName = $("#dropDownCategoryBooks").val();
               /* // alert($("#dropDown").val());

                var categoryParsed = categoryName.split("\n");
                 // alert("topic number is :"+categoryParsed[1]+":");
                 categoryName = categoryParsed[1].trim();
                 // alert(categoryName);

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = $("#dropDownBooks").val();

                 }*/

                 if(categoryName=="Please select"){
                    // alert("match in this case");
                    categoryName = categoryFetched;

                 }

                var bookName = $("#newBookIdBooks").val();
                 // alert("topic number is : "+bookName);
                var bookId = bookName+":"+topicNumber;
                 // alert("topic number is : "+bookId);


                /* if(($("#dropDownBooks").val()!="Please select")&&($("#dropDownBooks").text()!="Please select")){
                  // alert("matched here 1");
                  categoryName = $("#dropDownBooks").val();
                 }*/
                 // alert("hello");
                 // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);



                // inducing the logic for payment felicitation for paid books specially . 
                var paymentFlag = "unpaid"; // mark it 'unpaid'  intitially , it can be switched at ui layer intially to test paid/unpaid features

                 /*
                  Check with jquery function : 
                  // rough : I respect the copyrights of the purchased book . 
                  1. If code is in email search , mark 'paymentFlag' as 'paid'
                  2. If code isn't in email search , mark it as unpaid again 
                  getPaymentStatusForBook
                   */

                   // commenting out temporarily , also in below comment giving out the larger algorithm of payment structure 
                              // paymentflag is marked unpaid default
                              // on topic drop down click , there is payment status check
                              // if it's paid , it let's user read data
                              // if it's unpaid it prompts user with payment button 
                              // after completing payment , user is expected to accept reader license agreeemnt form which moves the payment information from inbox to db
                              // after doing the payment and accepting reading license agreement , once again when user clicks on dropdown to read the topic of the book -
                              // - , this time the payment status for the book now comes as paid and lets the user read the book after user completed the purchase -
                              // - process
                   /* jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/register/getPaymentStatusForBook/"+userNameFetched+"/"+bookName,
                        dataType: 'text',
                        async:false,
                        success: function(data){
                            // alert("came in the call back function"+data);
                            alert(" paymentStatus :  "+data);
                            paymentFlag = data;
                    }   
                        }); */
                  
                  

                

                //  commenting out temporarily
                /* if(paymentFlag=="unpaid"){
                  $("#paymentButton").show();
                  alert(" Copy the purposeOfPaymentCode to buy book to continue reading the book.");
                  // append amount in INR as well in the purpose code
                      // funcation to get bookPrice
                      var bookPrice = "";
                      jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/register/getAmoutByBookName/"+bookName,
                        dataType: 'text',
                        async:false,
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" price of book is  :  "+data);
                            bookPrice = data;
                    }   
                        }); 
                  $("#purposeOfPaymentCodeId").show();
                  $("paymentButton").show();
                  $("#purposeOfPaymentCodeId").text("PurposeOfPaymentCode :"+userNameFetched+"-"+bookName+"-INR"+bookPrice);
                  $("#paymentButton").text("Buy book");
                  }*/


                  // commenting out temporarily
               /*  else if(paymentFlag=="paid"){
                    $("#paymentButton").hide();
                    alert("as it's paid , it should come here");*/
             
                        $("#waitSymbolBooks").show();
                        jQuery.ajax({
                            url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userNameFetched+"/"+categoryName+"/"+bookId,
                            dataType: 'text',
                            success: function(data){
                               
                                if(data.length>0)
                                {
                                 var splittedData = data.split("&&**");
                                 var receivedTopicFromDatabaseArray = splittedData[1];
                                 var pageContent = splittedData[0];
                                 var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                 var topicName = topicNameArray[1];
                         $("#newTopicInputIdBooks").val(topicName);
                         // parsing page content to remove pre tags
                                    var pageContetnsWithPreTage = pageContent.split("pre>");
                                    var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                    var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                    var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                             $("#divTextAreaBooks").text(pageContentWithoutPreValue);
                            
                             $("#waitSymbolBooks").hide();
                           }
                           else{
                            // alert("topic doesn't exist");
                             $("#divTextAreaBooks").text(" No contents for this topic ! . It's empty .");
                              $("#newTopicInputIdBooks").val("");
                              $("#waitSymbolBooks").hide();
                           }

                        }   // end of success call back
                            });

                      // } // commenting out temporarily
                      // above terminating bracket is end of else if use case where payment of the unique book is already done . 

                  });   

                  // end of toic wise reading of book in write mode

                     // $('#dropDownBooks :selected').text(categoryName);
                     // $('#dropDown :selected').value(categoryName);

                     // alert(userName+categoryName);

                     // displaying books in book drop down when the category gets pre selected for certain logged out user
                        var ddlBooks = "#dropDownBooksBooks";
                        var listOfBooks = "";
                        var firstVariableForDropdown = "Please select book";
                       

                                jQuery.ajax({
                                            url: "http://localhost:8080/portal/portal/login/getBookListForUserAndCategory/"+userName+"/"+categoryName,
                                            dataType: 'text',
                                            success: function(data){
                                               
                                                                        listOfBooks = data;
                                                                        // alert("list of categories is : "+listOfCategories);
                                                                        var parsedListOfBooksRepeated = listOfBooks.split(",");
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        var parsedListOfBooks=parsedListOfBooksRepeated.filter(function(itm,i,parsedListOfBooksRepeated){
                                                                                return i==parsedListOfBooksRepeated.indexOf(itm);
                                                                            });
                                                                        // alert("parsed list of books is  : "+parsedListOfBooks);
                                                                        $(ddlBooks).empty();
                                                                        $(ddlBooks).append('<option value="' + firstVariableForDropdown + '">' + firstVariableForDropdown + "</option>'");
                                                                        for(var i=1;i<parsedListOfBooks.length;i++){
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( full-view )">' + parsedListOfBooks[i] + " - ( full-view )</option>'");
                                                                                 $(ddlBooks).append('<option value="' + parsedListOfBooks[i] + ' - ( quick-view )">' + parsedListOfBooks[i] + "- ( quick-view )</option>'");
                                                                        }
                                        }   
                                            }); 
                     // end of displaying of books for pre selected categories


                     // start of topic wise contents display while read mode for logged out user

                            $("#topicDropDownWhileReadBooks").change(function(){
                            // alert(" Value of selected book title : "+this.value); 
                            var topicNumber = this.value;

                            
                            /*var bookNameAndCategoryName = $("#bookTitleWhileReadBooks").text();
                            var bookName = bookNameAndCategoryName.split("(");
                            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
                            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
                            
                              if(categoryName=="Please select"){
                                  // alert("matched");
                                categoryName = $("#dropDownBooks").text();

                                 var categoryParsed = categoryName.split("\n");
                                   
                                  categoryName = categoryParsed[1].trim();
                                 
                                }*/

                                  var categoryName = $("#dropDownCategoryBooks").val();
                                  // var bookName = $("#dropDownBooksBooks").val();
                                   var bookName =  $("#newBookIdBooks").val();
                            

                            var bookId = bookName+":"+topicNumber;

                              // alert("category name is : "+categoryName+"username is : "+userName+"bookd id is : "+bookId);

                                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                                    $("#waitSymbolBooks").show();
                                    jQuery.ajax({
                                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userNameFetched+"/"+categoryName+"/"+bookId,
                                        dataType: 'text',
                                        success: function(data){
                                            
                                            if(data.length>0){
                                             var splittedData = data.split("&&**");
                                             var receivedTopicFromDatabaseArray = splittedData[1];
                                             var pageContent = splittedData[0];
                                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                                             var topicName = topicNameArray[1];
                                     $("#topicFetchedWhileReadBooks").text("");
                                     $("#topicFetchedWhileReadBooks").text(" Topic Name : "+topicName);
                                     // parsing page content to remove pre tags
                                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                                         $("#divTextAreaForReadBooks").text(pageContentWithoutPreValue);
                                         // $("#topicDropDown").val("1");
                                         // $("#newBookId").val(bookTrimmedName);
                                         $("#waitSymbolBooks").hide();
                                       }
                                         else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForReadBooks").text(" No contents for this topic ! . It's empty .");
                                             $("#waitSymbolBooks").hide();
                                             $("#topicFetchedWhileReadBooks").text("");
                                             $("#topicFetchedWhileReadBooks").text(" Topic Name : ");
                                           }

                                    }   
                                        });


                      });        

                     // end of topic wise contetns display while read mode for logged out user 


                     // start of method for closing of read view for logged out user

                    $("#closeButtonBooks").click(function(){
                            $("#bookLayoutBooks").hide();
                    });


                     // end of method for closing of read vierw for logged out user
                      // return false;
                      // e.die();
                   


                    }   
                        }); 



                   

                }
              /*if(keyInput.length > 12 ){
                alert("We request you to have category less than 12 characters");
                 $("#newCategoryInputId").val("");
              }*/
            });
            // end of search books funcionality


            $("#topicDropDownWhileRead").change(function(){
            // alert(" Value of selected book title : "+this.value); 
            var topicNumber = this.value;

            // alert("book name is : "+bookName);
            var userName = username[1];
            var bookNameAndCategoryName = $("#bookTitleWhileRead").text();
            var bookName = bookNameAndCategoryName.split("(");
            var bookNameWithoutLabel = bookName[0].substring(11,bookName[0].length-1).trim();
            var categoryName = bookName[1].substring(11,bookName[1].length-1).trim();
            // alert("book name is ="+bookNameWithoutLabel+"=");
            // alert("category name is ="+categoryName+"=");


            var bookId = bookNameWithoutLabel+":"+topicNumber;

                    // rough work : "getBookDetailsByBookId/{username}/{category}/{bookId}"
                    $("#waitSymbol").show();
                    jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getBookDetailsByBookId/"+userName+"/"+categoryName+"/"+bookId,
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                            // alert(" book details are :  "+data);
                            // resetting the editor after the save action 
                            // alert("data received is : "+data);
                            if(data.length>0){
                             var splittedData = data.split("&&**");
                             var receivedTopicFromDatabaseArray = splittedData[1];
                             var pageContent = splittedData[0];
                             var topicNameArray = receivedTopicFromDatabaseArray.split(":");
                             var topicName = topicNameArray[1];
                     $("#topicFetchedWhileRead").text("");
                     $("#topicFetchedWhileRead").text(" Topic Name : "+topicName);
                     // parsing page content to remove pre tags
                                var pageContetnsWithPreTage = pageContent.split("pre>");
                                var pageContentWithoutPre = pageContetnsWithPreTage[1];
                                var pageContetnsWithPreTageArray = pageContentWithoutPre.split("</");
                                var pageContentWithoutPreValue = pageContetnsWithPreTageArray[0];
                         $("#divTextAreaForRead").text(pageContentWithoutPreValue);
                         $("#waitSymbol").hide();
                         // $("#topicDropDown").val("1");
                         // $("#newBookId").val(bookTrimmedName);
                       }
                                       else{
                                            // alert("topic doesn't exist");
                                             $("#divTextAreaForRead").text(" No contents for this topic ! . It's empty .");
                                              $("#waitSymbol").hide();
                                              $("#topicFetchedWhileRead").text("");
                                             $("#topicFetchedWhileRead").text(" Topic Name : ");
                                           }

                    }   
                        });


      });         





 
 




}); // end of document ready method


</script>






<script>
// opening default tab and opening tab selectively on click


    var availableTags =  [
    ];
    var availableBookTags = [
    ];

function openCity(evt, cityName) {
    // alert("here");

    if(cityName=="fullScreenDivForMyHome"){
     
        /*var parameters = location.search.substring(1).split("&");
      var username = parameters[0].split("=");
      history.pushState("thinker", "book-title", "http://localhost:8080/portal/library/"+username[1]);*/

      // this code and the code of pushstate under thinkers condition below will come into effect once , the full tabs functionalities are working for logged out user as well . Above codes will be uncommented then . 
      // alert("came here");
      
      $("#zones").show();
      $("#searchThinkers").hide();
       $("#searchBooks").hide();
        $("#logoutPlaceHolderThinkers").show();
      // $("registerPlaceHolder").show();
     
    }

     if(cityName=="fullScreenDivForThinkers"){
      // alert("hello");
      $("#searchBooks").hide();
      $("#searchThinkers").show(10);
       $("#searchThinkers").val("    Search thinkers ...");
       $("#registerPlaceHolderThinkers").hide();
      $("#logoutPlaceHolderThinkers").hide();
      $("#newCategoryInputIdThinkers").hide();
      $("#newCategoryInputButtonIdThinkers").hide();

      $("#divTextAreaThinkers").prop("readonly","true");
      $("#newBookIdThinkers").prop("disabled","true");
       $("#divTextAreaForReadThinkers").prop("readonly","true");
       $("#newTopicInputIdThinkers").prop("disabled","true");
        $("#newBookButtonIdThinkers").hide(); 


             jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getAllUsers",
                        dataType: 'text',
                        async:false,
                        success: function(data){
                            // alert("came in the call back function"+data);
                           
                            data = data.substring(1,data.length);
                             // alert(" userList :  "+data);
                            var userListSplittedArray = data.split(",");

                            for(var i=0;i<userListSplittedArray.length;i++){
                              availableTags[i] = userListSplittedArray[i];
                              // alert("helloavtags : "+availableTags[i])
                            }
                            // alert("availableTags"+availableTags);


                            // $( function() {
                                 
                                $( "#searchThinkers").autocomplete({
                                  minLength : 3,
                                  source: function(request, response) {
                                    // alert("hello::"+availableTags);
                                    var results = $.ui.autocomplete.filter(availableTags, request.term);

                                    response(results.slice(0, 10));
                                }
                                });
                              // } );



                    }   
                        }); 

           



       // history.pushState("thinkers", "book-title", "http://localhost:8080/portal/library/thinkers");

      // $("#registerPlaceHolder").hide();
    }

     if(cityName=="fullScreenDivForBooks"){
      $("#searchThinkers").hide();
      $("#searchBooks").show(10);
       $("#searchBooks").val("    Search books ...");
        $("#registerPlaceHolderBooks").hide();
      $("#logoutPlaceHolderBooks").hide();
       $("#newCategoryInputIdBooks").hide();
      $("#newCategoryInputButtonIdBooks").hide();

       $("#divTextAreaBooks").prop("readonly","true");
      $("#newBookIdBooks").prop("disabled","true");
       $("#divTextAreaForReadBooks").prop("readonly","true");
       $("#newTopicInputIdBooks").prop("disabled","true");
        $("#newBookButtonIdBooks").hide(); 
          $("#paymentButton").hide();
          $("#purposeOfPaymentCodeId").hide();
          $("#agreementTextId").hide();
          $("#agreeId").hide();




         jQuery.ajax({
                        url: "http://localhost:8080/portal/portal/login/getAllDistinctBooks",
                        dataType: 'text',
                        success: function(data){
                            // alert("came in the call back function"+data);
                           
                            data = data.substring(1,data.length);
                             // alert(" userList :  "+data);
                            var bookListSplittedArray = data.split(",");
                            for(var i=0;i<bookListSplittedArray.length;i++){
                              availableBookTags[i] = bookListSplittedArray[i];
                              // alert("hello : "+availableBookTags[i])
                            }

                             $("#searchBooks").autocomplete({
                             minLength : 3,
                            source: function(request, response) {
                              var results = $.ui.autocomplete.filter(availableBookTags, request.term);

                              response(results.slice(0, 10));
                          }
                          });


                    }   
                        }); 

           



       // history.pushState("thinkers", "book-title", "http://localhost:8080/portal/library/thinkers");

      // $("#registerPlaceHolder").hide();
    }

    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
}
// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();


</script>






   <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js" ></script> 
     <script src="https://d2xwmjc4uy2hr5.cloudfront.net/im-embed/im-embed.min.js"></script>
<link href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" rel="Stylesheet"></link>






</head>

</html>

